"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.postBuild = postBuild;
const core_1 = require("@ng-doc/core");
const operators_1 = require("rxjs/operators");
const operators_2 = require("../../operators");
const error_handler_1 = require("../../operators/error-handler");
const plugins_1 = require("../entities/plugins");
/**
 *
 */
function postBuild() {
    return (source) => source.pipe((0, operators_1.switchMap)((outputs) => (0, operators_2.forkJoinOrEmpty)(outputs.map((output) => handlePostBuild(output).pipe((0, error_handler_1.errorHandler)(output))))));
}
/**
 *
 * @param output
 */
function handlePostBuild(output) {
    return (0, plugins_1.executePlugins)(output.result, output.entity, (0, core_1.asArray)(output.postBuildPlugins)).pipe((0, operators_1.map)((result) => Object.assign({}, output, { result })));
}
//# sourceMappingURL=post-build.js.map