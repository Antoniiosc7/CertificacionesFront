"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.patchBuilderContext = patchBuilderContext;
const tslib_1 = require("tslib");
// The DevServer uses EsBuild only for specific builder names.
// https://github.com/just-jeb/angular-builders/blob/dbf4d281a29c2f93d309bba0e155c3a22965130c/packages/custom-esbuild/src/dev-server/patch-builder-context.ts#L14-L47
/**
 *
 * @param context
 * @param config
 * @param config.mock
 * @param config.with
 * @param config.optionsTransform
 */
function patchBuilderContext(context, config) {
    const getBuilderNameForTarget = (target) => tslib_1.__awaiter(this, void 0, void 0, function* () {
        const builderName = yield context.getBuilderNameForTarget(target);
        if (!config.mock.includes(builderName))
            return builderName;
        return config.with;
    });
    const getTargetOptions = (target) => tslib_1.__awaiter(this, void 0, void 0, function* () {
        const builderName = yield context.getBuilderNameForTarget(target);
        if (!config.mock.includes(builderName))
            return context.getTargetOptions(target);
        const options = yield context.getTargetOptions(target);
        config.optionsTransform(options);
        return options;
    });
    return Object.assign(Object.assign({}, context), { getBuilderNameForTarget, getTargetOptions });
}
//# sourceMappingURL=patch-builder-context.js.map