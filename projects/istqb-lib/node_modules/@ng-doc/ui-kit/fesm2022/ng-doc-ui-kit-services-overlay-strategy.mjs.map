{"version":3,"file":"ng-doc-ui-kit-services-overlay-strategy.mjs","sources":["../../../../libs/ui-kit/services/overlay-strategy/overlay-strategy.ts","../../../../libs/ui-kit/services/overlay-strategy/ng-doc-ui-kit-services-overlay-strategy.ts"],"sourcesContent":["import { OverlayRef, ScrollStrategy } from '@angular/cdk/overlay';\nimport { DOCUMENT } from '@angular/common';\nimport { Inject, Injectable, NgZone } from '@angular/core';\nimport { toElement } from '@ng-doc/ui-kit/helpers';\nimport { NgDocOverlayConfig } from '@ng-doc/ui-kit/interfaces';\nimport { ngDocZoneDetach } from '@ng-doc/ui-kit/observables';\nimport { fromEvent, Subject } from 'rxjs';\nimport { filter, map, takeUntil, throttleTime } from 'rxjs/operators';\n\n@Injectable({ providedIn: 'root' })\nexport class NgDocOverlayStrategy implements ScrollStrategy {\n\tprivate overlayRef: OverlayRef | null = null;\n\tprivate destroy$: Subject<void> = new Subject<void>();\n\n\tconstructor(\n\t\t@Inject(DOCUMENT) private documentRef: Document,\n\t\tprivate ngZone: NgZone,\n\t) {}\n\n\tattach(overlayRef: OverlayRef): void {\n\t\tthis.overlayRef = overlayRef;\n\t}\n\n\tenable(): void {\n\t\tfromEvent(this.documentRef, 'scroll', { capture: true })\n\t\t\t.pipe(\n\t\t\t\tngDocZoneDetach(this.ngZone),\n\t\t\t\tthrottleTime(10),\n\t\t\t\tmap((scrollEvent: Event) =>\n\t\t\t\t\tscrollEvent.target instanceof Document\n\t\t\t\t\t\t? scrollEvent.target.scrollingElement\n\t\t\t\t\t\t: scrollEvent.target,\n\t\t\t\t),\n\t\t\t\tfilter((target: EventTarget | null) =>\n\t\t\t\t\ttarget instanceof Node ? target.contains(this.origin) || !this.origin : false,\n\t\t\t\t),\n\t\t\t\ttakeUntil(this.destroy$),\n\t\t\t)\n\t\t\t.subscribe(() => this.detach());\n\t}\n\n\tprivate get origin(): HTMLElement | null {\n\t\tconst config: NgDocOverlayConfig | undefined =\n\t\t\tthis.overlayRef?.getConfig() as NgDocOverlayConfig;\n\t\treturn config?.viewContainerRef\n\t\t\t? (toElement(config.viewContainerRef.element) as HTMLElement)\n\t\t\t: null;\n\t}\n\n\tdisable(): void {\n\t\tthis.destroy$.next();\n\t}\n\n\tdetach(): void {\n\t\tthis.disable();\n\t\tif (this.overlayRef?.hasAttached()) {\n\t\t\tthis.ngZone.run(() => {\n\t\t\t\tthis.overlayRef?.detach();\n\t\t\t});\n\t\t}\n\t}\n}\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":";;;;;;;;MAUa,oBAAoB,CAAA;IAIhC,WAC2B,CAAA,WAAqB,EACvC,MAAc,EAAA;QADI,IAAW,CAAA,WAAA,GAAX,WAAW,CAAU;QACvC,IAAM,CAAA,MAAA,GAAN,MAAM,CAAQ;QALf,IAAU,CAAA,UAAA,GAAsB,IAAI,CAAC;AACrC,QAAA,IAAA,CAAA,QAAQ,GAAkB,IAAI,OAAO,EAAQ,CAAC;KAKlD;AAEJ,IAAA,MAAM,CAAC,UAAsB,EAAA;AAC5B,QAAA,IAAI,CAAC,UAAU,GAAG,UAAU,CAAC;KAC7B;IAED,MAAM,GAAA;AACL,QAAA,SAAS,CAAC,IAAI,CAAC,WAAW,EAAE,QAAQ,EAAE,EAAE,OAAO,EAAE,IAAI,EAAE,CAAC;aACtD,IAAI,CACJ,eAAe,CAAC,IAAI,CAAC,MAAM,CAAC,EAC5B,YAAY,CAAC,EAAE,CAAC,EAChB,GAAG,CAAC,CAAC,WAAkB,KACtB,WAAW,CAAC,MAAM,YAAY,QAAQ;AACrC,cAAE,WAAW,CAAC,MAAM,CAAC,gBAAgB;cACnC,WAAW,CAAC,MAAM,CACrB,EACD,MAAM,CAAC,CAAC,MAA0B,KACjC,MAAM,YAAY,IAAI,GAAG,MAAM,CAAC,QAAQ,CAAC,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,MAAM,GAAG,KAAK,CAC7E,EACD,SAAS,CAAC,IAAI,CAAC,QAAQ,CAAC,CACxB;aACA,SAAS,CAAC,MAAM,IAAI,CAAC,MAAM,EAAE,CAAC,CAAC;KACjC;AAED,IAAA,IAAY,MAAM,GAAA;QACjB,MAAM,MAAM,GACX,IAAI,CAAC,UAAU,EAAE,SAAS,EAAwB,CAAC;QACpD,OAAO,MAAM,EAAE,gBAAgB;cAC3B,SAAS,CAAC,MAAM,CAAC,gBAAgB,CAAC,OAAO,CAAiB;cAC3D,IAAI,CAAC;KACR;IAED,OAAO,GAAA;AACN,QAAA,IAAI,CAAC,QAAQ,CAAC,IAAI,EAAE,CAAC;KACrB;IAED,MAAM,GAAA;QACL,IAAI,CAAC,OAAO,EAAE,CAAC;AACf,QAAA,IAAI,IAAI,CAAC,UAAU,EAAE,WAAW,EAAE,EAAE;AACnC,YAAA,IAAI,CAAC,MAAM,CAAC,GAAG,CAAC,MAAK;AACpB,gBAAA,IAAI,CAAC,UAAU,EAAE,MAAM,EAAE,CAAC;AAC3B,aAAC,CAAC,CAAC;SACH;KACD;AAlDW,IAAA,SAAA,IAAA,CAAA,IAAA,GAAA,EAAA,CAAA,kBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,oBAAoB,kBAKvB,QAAQ,EAAA,EAAA,EAAA,KAAA,EAAA,EAAA,CAAA,MAAA,EAAA,CAAA,EAAA,MAAA,EAAA,EAAA,CAAA,eAAA,CAAA,UAAA,EAAA,CAAA,CAAA,EAAA;AALL,IAAA,SAAA,IAAA,CAAA,KAAA,GAAA,EAAA,CAAA,qBAAA,CAAA,EAAA,UAAA,EAAA,QAAA,EAAA,OAAA,EAAA,QAAA,EAAA,QAAA,EAAA,EAAA,EAAA,IAAA,EAAA,oBAAoB,cADP,MAAM,EAAA,CAAA,CAAA,EAAA;;2FACnB,oBAAoB,EAAA,UAAA,EAAA,CAAA;kBADhC,UAAU;mBAAC,EAAE,UAAU,EAAE,MAAM,EAAE,CAAA;;0BAM/B,MAAM;2BAAC,QAAQ,CAAA;;;ACflB;;AAEG;;;;"}