import { NgFor, NgIf } from '@angular/common';
import { ChangeDetectionStrategy, Component, Input, } from '@angular/core';
import { FormBuilder } from '@angular/forms';
import { NgDocRootPage } from '@ng-doc/app/classes/root-page';
import { isSameObject } from '@ng-doc/core';
import { objectKeys } from '@ng-doc/core/helpers/object-keys';
import { NgDocAsArrayPipe } from '@ng-doc/ui-kit';
import { NgDocPlaygroundDemoComponent } from './playground-demo/playground-demo.component';
import { NgDocPlaygroundPropertiesComponent } from './playground-properties/playground-properties.component';
import * as i0 from "@angular/core";
import * as i1 from "@ng-doc/app/classes/root-page";
import * as i2 from "@angular/forms";
export class NgDocPlaygroundComponent {
    constructor(rootPage, formBuilder) {
        this.rootPage = rootPage;
        this.formBuilder = formBuilder;
        this.id = '';
        this.pipeName = '';
        this.selectors = [];
        this.options = {};
        this.recreateDemo = false;
        this.defaultProperties = {};
        this.defaultContent = {};
    }
    ngOnChanges({ options }) {
        if (options) {
            // Join configuration with options
            this.configuration = Object.assign({}, this.rootPage.page?.playgrounds?.[this.id], this.options);
        }
    }
    ngAfterViewInit() {
        this.defaultProperties = this.getPropertiesFormValues();
        this.defaultContent = this.getContentFormValues();
        const propertiesForm = this.formBuilder.group(this.defaultProperties);
        const contentForm = this.formBuilder.group(this.defaultContent);
        this.formGroup = this.formBuilder.group({
            properties: propertiesForm,
            content: contentForm,
        });
        // `patchValue` is needed to set `undefined` values, otherwise they will be ignored by the Angular form
        this.formGroup.patchValue({
            properties: Object.assign({}, this.defaultProperties, this.configuration.inputs),
            content: this.defaultContent,
        });
    }
    isDefaultState() {
        if (!this.formGroup) {
            return false;
        }
        return (isSameObject(this.formGroup.value.properties ?? {}, this.defaultValues ?? {}) &&
            isSameObject(this.formGroup.value.content ?? {}, this.defaultContent ?? {}));
    }
    getPropertiesFormValues() {
        const formValues = objectKeys(this.properties ?? {}).reduce((controls, key) => {
            if (this.properties) {
                controls[key] = this.defaultValues ? this.defaultValues[key] : undefined;
            }
            return controls;
        }, {});
        return Object.assign({}, formValues, this.configuration.defaults);
    }
    getContentFormValues() {
        return objectKeys(this.configuration?.content ?? {}).reduce((controls, key) => {
            if (this.configuration?.content) {
                controls[key] = false;
            }
            return controls;
        }, {});
    }
    resetForm() {
        this.formGroup.reset({}, { emitEvent: false });
        this.formGroup?.patchValue({
            properties: this.defaultProperties,
            content: this.defaultContent,
        });
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.1.0", ngImport: i0, type: NgDocPlaygroundComponent, deps: [{ token: i1.NgDocRootPage }, { token: i2.FormBuilder }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "18.1.0", type: NgDocPlaygroundComponent, isStandalone: true, selector: "ng-doc-playground", inputs: { id: "id", pipeName: "pipeName", selectors: "selectors", properties: "properties", options: "options" }, usesOnChanges: true, ngImport: i0, template: "<ng-container *ngIf=\"configuration\">\n\t<ng-doc-playground-properties\n\t\t[form]=\"formGroup\"\n\t\t[properties]=\"properties\"\n\t\t[ignoreInputs]=\"configuration.hiddenInputs\"\n\t\t[dynamicContent]=\"configuration.content\"\n\t\t[hideSidePanel]=\"configuration.hideSidePanel ?? false\"\n\t\t[defaultValues]=\"defaultValues\"\n\t\t[showResetButton]=\"!isDefaultState()\"\n\t\t[(recreateDemo)]=\"recreateDemo\"\n\t\t(resetForm)=\"resetForm()\">\n\t\t<ng-doc-playground-demo\n\t\t\t*ngFor=\"let selector of configuration.selectors ?? selectors | asArray\"\n\t\t\t[id]=\"id\"\n\t\t\t[selector]=\"selector\"\n\t\t\t[properties]=\"properties\"\n\t\t\t[configuration]=\"configuration\"\n\t\t\t[recreateDemo]=\"recreateDemo\"\n\t\t\t[form]=\"formGroup\"\n\t\t\t[expanded]=\"configuration.expanded ?? false\">\n\t\t</ng-doc-playground-demo>\n\n\t\t<ng-doc-playground-demo\n\t\t\t*ngIf=\"pipeName\"\n\t\t\t[id]=\"id\"\n\t\t\t[pipeName]=\"pipeName\"\n\t\t\t[properties]=\"properties\"\n\t\t\t[configuration]=\"configuration\"\n\t\t\t[recreateDemo]=\"recreateDemo\"\n\t\t\t[form]=\"formGroup\">\n\t\t</ng-doc-playground-demo>\n\t</ng-doc-playground-properties>\n</ng-container>\n", styles: [":host{display:block;margin:var(--ng-doc-playground-margin)}\n"], dependencies: [{ kind: "directive", type: NgIf, selector: "[ngIf]", inputs: ["ngIf", "ngIfThen", "ngIfElse"] }, { kind: "component", type: NgDocPlaygroundPropertiesComponent, selector: "ng-doc-playground-properties", inputs: ["form", "properties", "ignoreInputs", "dynamicContent", "defaultValues", "hideSidePanel", "recreateDemo", "showResetButton"], outputs: ["recreateDemoChange", "resetForm"] }, { kind: "directive", type: NgFor, selector: "[ngFor][ngForOf]", inputs: ["ngForOf", "ngForTrackBy", "ngForTemplate"] }, { kind: "component", type: NgDocPlaygroundDemoComponent, selector: "ng-doc-playground-demo", inputs: ["id", "pipeName", "selector", "configuration", "properties", "recreateDemo", "form", "expanded"] }, { kind: "pipe", type: NgDocAsArrayPipe, name: "asArray" }], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.1.0", ngImport: i0, type: NgDocPlaygroundComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ng-doc-playground', changeDetection: ChangeDetectionStrategy.OnPush, standalone: true, imports: [
                        NgIf,
                        NgDocPlaygroundPropertiesComponent,
                        NgFor,
                        NgDocPlaygroundDemoComponent,
                        NgDocAsArrayPipe,
                    ], template: "<ng-container *ngIf=\"configuration\">\n\t<ng-doc-playground-properties\n\t\t[form]=\"formGroup\"\n\t\t[properties]=\"properties\"\n\t\t[ignoreInputs]=\"configuration.hiddenInputs\"\n\t\t[dynamicContent]=\"configuration.content\"\n\t\t[hideSidePanel]=\"configuration.hideSidePanel ?? false\"\n\t\t[defaultValues]=\"defaultValues\"\n\t\t[showResetButton]=\"!isDefaultState()\"\n\t\t[(recreateDemo)]=\"recreateDemo\"\n\t\t(resetForm)=\"resetForm()\">\n\t\t<ng-doc-playground-demo\n\t\t\t*ngFor=\"let selector of configuration.selectors ?? selectors | asArray\"\n\t\t\t[id]=\"id\"\n\t\t\t[selector]=\"selector\"\n\t\t\t[properties]=\"properties\"\n\t\t\t[configuration]=\"configuration\"\n\t\t\t[recreateDemo]=\"recreateDemo\"\n\t\t\t[form]=\"formGroup\"\n\t\t\t[expanded]=\"configuration.expanded ?? false\">\n\t\t</ng-doc-playground-demo>\n\n\t\t<ng-doc-playground-demo\n\t\t\t*ngIf=\"pipeName\"\n\t\t\t[id]=\"id\"\n\t\t\t[pipeName]=\"pipeName\"\n\t\t\t[properties]=\"properties\"\n\t\t\t[configuration]=\"configuration\"\n\t\t\t[recreateDemo]=\"recreateDemo\"\n\t\t\t[form]=\"formGroup\">\n\t\t</ng-doc-playground-demo>\n\t</ng-doc-playground-properties>\n</ng-container>\n", styles: [":host{display:block;margin:var(--ng-doc-playground-margin)}\n"] }]
        }], ctorParameters: () => [{ type: i1.NgDocRootPage }, { type: i2.FormBuilder }], propDecorators: { id: [{
                type: Input,
                args: [{ required: true }]
            }], pipeName: [{
                type: Input
            }], selectors: [{
                type: Input
            }], properties: [{
                type: Input
            }], options: [{
                type: Input
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGxheWdyb3VuZC5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9saWJzL2FwcC9jb21wb25lbnRzL3BsYXlncm91bmQvcGxheWdyb3VuZC5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9saWJzL2FwcC9jb21wb25lbnRzL3BsYXlncm91bmQvcGxheWdyb3VuZC5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsS0FBSyxFQUFFLElBQUksRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzlDLE9BQU8sRUFFTix1QkFBdUIsRUFDdkIsU0FBUyxFQUNULEtBQUssR0FHTCxNQUFNLGVBQWUsQ0FBQztBQUN2QixPQUFPLEVBQUUsV0FBVyxFQUFhLE1BQU0sZ0JBQWdCLENBQUM7QUFDeEQsT0FBTyxFQUFFLGFBQWEsRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBQzlELE9BQU8sRUFBRSxZQUFZLEVBQUUsTUFBTSxjQUFjLENBQUM7QUFDNUMsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLGtDQUFrQyxDQUFDO0FBTTlELE9BQU8sRUFBRSxnQkFBZ0IsRUFBRSxNQUFNLGdCQUFnQixDQUFDO0FBRWxELE9BQU8sRUFBRSw0QkFBNEIsRUFBRSxNQUFNLDZDQUE2QyxDQUFDO0FBRTNGLE9BQU8sRUFBRSxrQ0FBa0MsRUFBRSxNQUFNLHlEQUF5RCxDQUFDOzs7O0FBZ0I3RyxNQUFNLE9BQU8sd0JBQXdCO0lBMkJwQyxZQUNrQixRQUF1QixFQUN2QixXQUF3QjtRQUR4QixhQUFRLEdBQVIsUUFBUSxDQUFlO1FBQ3ZCLGdCQUFXLEdBQVgsV0FBVyxDQUFhO1FBeEIxQyxPQUFFLEdBQVcsRUFBRSxDQUFDO1FBR2hCLGFBQVEsR0FBVyxFQUFFLENBQUM7UUFHdEIsY0FBUyxHQUFhLEVBQUUsQ0FBQztRQU16QixZQUFPLEdBQTJCLEVBQUUsQ0FBQztRQUVyQyxpQkFBWSxH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LE9BQU8sRUFBRSxDQUFDO2dCQUNqQyxRQUFRLENBQUMsR0FBRyxDQUFDLEdBQUcsS0FBSyxDQUFDO1lBQ3ZCLENBQUM7WUFFRCxPQUFPLFFBQVEsQ0FBQztRQUNqQixDQUFDLEVBQ0QsRUFBOEIsQ0FDOUIsQ0FBQztJQUNILENBQUM7SUFFRCxTQUFTO1FBQ1IsSUFBSSxDQUFDLFNBQVMsQ0FBQyxLQUFLLENBQUMsRUFBRSxFQUFFLEVBQUUsU0FBUyxFQUFFLEtBQUssRUFBRSxDQUFDLENBQUM7UUFDL0MsSUFBSSxDQUFDLFNBQVMsRUFBRSxVQUFVLENBQUM7WUFDMUIsVUFBVSxFQUFFLElBQUksQ0FBQyxpQkFBaUI7WUFDbEMsT0FBTyxFQUFFLElBQUksQ0FBQyxjQUFjO1NBQzVCLENBQUMsQ0FBQztJQUNKLENBQUM7OEdBMUdXLHdCQUF3QjtrR0FBeEIsd0JBQXdCLG9OQ3RDckMsdXBDQWlDQSx1SERGRSxJQUFJLDZGQUNKLGtDQUFrQyw4UEFDbEMsS0FBSyxtSEFDTCw0QkFBNEIseUtBQzVCLGdCQUFnQjs7MkZBR0wsd0JBQXdCO2tCQWRwQyxTQUFTOytCQUNDLG1CQUFtQixtQkFHWix1QkFBdUIsQ0FBQyxNQUFNLGNBQ25DLElBQUksV0FDUDt3QkFDUixJQUFJO3dCQUNKLGtDQUFrQzt3QkFDbEMsS0FBSzt3QkFDTCw0QkFBNEI7d0JBQzVCLGdCQUFnQjtxQkFDaEI7NEdBT0QsRUFBRTtzQkFERCxLQUFLO3VCQUFDLEVBQUUsUUFBUSxFQUFFLElBQUksRUFBRTtnQkFJekIsUUFBUTtzQkFEUCxLQUFLO2dCQUlOLFNBQVM7c0JBRFIsS0FBSztnQkFJTixVQUFVO3NCQURULEtBQUs7Z0JBSU4sT0FBTztzQkFETixLQUFLIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgTmdGb3IsIE5nSWYgfSBmcm9tICdAYW5ndWxhci9jb21tb24nO1xuaW1wb3J0IHtcblx0QWZ0ZXJWaWV3SW5pdCxcblx0Q2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG5cdENvbXBvbmVudCxcblx0SW5wdXQsXG5cdE9uQ2hhbmdlcyxcblx0U2ltcGxlQ2hhbmdlcyxcbn0gZnJvbSAnQGFuZ3VsYXIvY29yZSc7XG5pbXBvcnQgeyBGb3JtQnVpbGRlciwgRm9ybUdyb3VwIH0gZnJvbSAnQGFuZ3VsYXIvZm9ybXMnO1xuaW1wb3J0IHsgTmdEb2NSb290UGFnZSB9IGZyb20gJ0BuZy1kb2MvYXBwL2NsYXNzZXMvcm9vdC1wYWdlJztcbmltcG9ydCB7IGlzU2FtZU9iamVjdCB9IGZyb20gJ0BuZy1kb2MvY29yZSc7XG5pbXBvcnQgeyBvYmplY3RLZXlzIH0gZnJvbSAnQG5nLWRvYy9jb3JlL2hlbHBlcnMvb2JqZWN0LWtleXMnO1xuaW1wb3J0IHtcblx0TmdEb2NQbGF5Z3JvdW5kQ29uZmlnLFxuXHROZ0RvY1BsYXlncm91bmRPcHRpb25zLFxuXHROZ0RvY1BsYXlncm91bmRQcm9wZXJ0aWVzLFxufSBmcm9tICdAbmctZG9jL2NvcmUvaW50ZXJmYWNlcyc7XG5pbXBvcnQgeyBOZ0RvY0FzQXJyYXlQaXBlIH0gZnJvbSAnQG5nLWRvYy91aS1raXQnO1xuXG5pbXBvcnQgeyBOZ0RvY1BsYXlncm91bmREZW1vQ29tcG9uZW50IH0gZnJvbSAnLi9wbGF5Z3JvdW5kLWRlbW8vcGxheWdyb3VuZC1kZW1vLmNvbXBvbmVudCc7XG5pbXBvcnQgeyBOZ0RvY1BsYXlncm91bmRGb3JtIH0gZnJvbSAnLi9wbGF5Z3JvdW5kLWZvcm0nO1xuaW1wb3J0IHsgTmdEb2NQbGF5Z3JvdW5kUHJvcGVydGllc0NvbXBvbmVudCB9IGZyb20gJy4vcGxheWdyb3VuZC1wcm9wZXJ0aWVzL3BsYXlncm91bmQtcHJvcGVydGllcy5jb21wb25lbnQnO1xuXG5AQ29tcG9uZW50KHtcblx0c2VsZWN0b3I6ICduZy1kb2MtcGxheWdyb3VuZCcsXG5cdHRlbXBsYXRlVXJsOiAnLi9wbGF5Z3JvdW5kLmNvbXBvbmVudC5odG1sJyxcblx0c3R5bGVVcmxzOiBbJy4vcGxheWdyb3VuZC5jb21wb25lbnQuc2NzcyddLFxuXHRjaGFuZ2VEZXRlY3Rpb246IENoYW5nZURldGVjdGlvblN0cmF0ZWd5Lk9uUHVzaCxcblx0c3RhbmRhbG9uZTogdHJ1ZSxcblx0aW1wb3J0czogW1xuXHRcdE5nSWYsXG5cdFx0TmdEb2NQbGF5Z3JvdW5kUHJvcGVydGllc0NvbXBvbmVudCxcblx0XHROZ0Zvcixcblx0XHROZ0RvY1BsYXlncm91bmREZW1vQ29tcG9uZW50LFxuXHRcdE5nRG9jQXNBcnJheVBpcGUsXG5cdF0sXG59KVxuZXhwb3J0IGNsYXNzIE5nRG9jUGxheWdyb3VuZENvbXBvbmVudDxcblx0VCBleHRlbmRzIE5nRG9jUGxheWdyb3VuZFByb3BlcnRpZXMgPSBOZ0RvY1BsYXlncm91bmRQcm9wZXJ0aWVzLFxuPiBpbXBsZW1lbnRzIE9uQ2hhbmdlcywgQWZ0ZXJWaWV3SW5pdFxue1xuXHRASW5wdXQoeyByZXF1aXJlZDogdHJ1ZSB9KVxuXHRpZDogc3RyaW5nID0gJyc7XG5cblx0QElucHV0KClcblx0cGlwZU5hbWU6IHN0cmluZyA9ICcnO1xuXG5cdEBJbnB1dCgpXG5cdHNlbGVjdG9yczogc3RyaW5nW10gPSBbXTtcblxuXHRASW5wdXQoKVxuXHRwcm9wZXJ0aWVzPzogVDtcblxuXHRASW5wdXQoKVxuXHRvcHRpb25zOiBOZ0RvY1BsYXlncm91bmRPcHRpb25zID0ge307XG5cblx0cmVjcmVhdGVEZW1vOiBib29sZWFuID0gZmFsc2U7XG5cdGZvcm1Hcm91cCE6IEZvcm1Hcm91cDxOZ0RvY1BsYXlncm91bmRGb3JtPjtcblx0ZGVmYXVsdFZhbHVlcz86IFJlY29yZDxzdHJpbmcsIHVua25vd24+O1xuXHRjb25maWd1cmF0aW9uITogTmdEb2NQbGF5Z3JvdW5kQ29uZmlnO1xuXG5cdHByaXZhdGUgZGVmYXVsdFByb3BlcnRpZXM6IFJlY29yZDxzdHJpbmcsIHVua25vd24+ID0ge307XG5cdHByaXZhdGUgZGVmYXVsdENvbnRlbnQ6IFJlY29yZDxzdHJpbmcsIGJvb2xlYW4+ID0ge307XG5cblx0Y29uc3RydWN0b3IoXG5cdFx0cHJpdmF0ZSByZWFkb25seSByb290UGFnZTogTmdEb2NSb290UGFnZSxcblx0XHRwcml2YXRlIHJlYWRvbmx5IGZvcm1CdWlsZGVyOiBGb3JtQnVpbGRlcixcblx0KSB7fVxuXG5cdG5nT25DaGFuZ2VzKHsgb3B0aW9ucyB9OiBTaW1wbGVDaGFuZ2VzKSB7XG5cdFx0aWYgKG9wdGlvbnMpIHtcblx0XHRcdC8vIEpvaW4gY29uZmlndXJhdGlvbiB3aXRoIG9wdGlvbnNcblx0XHRcdHRoaXMuY29uZmlndXJhdGlvbiA9IE9iamVjdC5hc3NpZ24oXG5cdFx0XHRcdHt9LFxuXHRcdFx0XHR0aGlzLnJvb3RQYWdlLnBhZ2U/LnBsYXlncm91bmRzPy5bdGhpcy5pZF0sXG5cdFx0XHRcdHRoaXMub3B0aW9ucyxcblx0XHRcdCk7XG5cdFx0fVxuXHR9XG5cblx0bmdBZnRlclZpZXdJbml0KCk6IHZvaWQge1xuXHRcdHRoaXMuZGVmYXVsdFByb3BlcnRpZXMgPSB0aGlzLmdldFByb3BlcnRpZXNGb3JtVmFsdWVzKCk7XG5cdFx0dGhpcy5kZWZhdWx0Q29udGVudCA9IHRoaXMuZ2V0Q29udGVudEZvcm1WYWx1ZXMoKTtcblxuXHRcdGNvbnN0IHByb3BlcnRpZXNGb3JtOiBGb3JtR3JvdXAgPSB0aGlzLmZvcm1CdWlsZGVyLmdyb3VwKHRoaXMuZGVmYXVsdFByb3BlcnRpZXMpO1xuXHRcdGNvbnN0IGNvbnRlbnRGb3JtOiBGb3JtR3JvdXAgPSB0aGlzLmZvcm1CdWlsZGVyLmdyb3VwKHRoaXMuZGVmYXVsdENvbnRlbnQpO1xuXG5cdFx0dGhpcy5mb3JtR3JvdXAgPSB0aGlzLmZvcm1CdWlsZGVyLmdyb3VwKHtcblx0XHRcdHByb3BlcnRpZXM6IHByb3BlcnRpZXNGb3JtLFxuXHRcdFx0Y29udGVudDogY29udGVudEZvcm0sXG5cdFx0fSk7XG5cdFx0Ly8gYHBhdGNoVmFsdWVgIGlzIG5lZWRlZCB0byBzZXQgYHVuZGVmaW5lZGAgdmFsdWVzLCBvdGhlcndpc2UgdGhleSB3aWxsIGJlIGlnbm9yZWQgYnkgdGhlIEFuZ3VsYXIgZm9ybVxuXHRcdHRoaXMuZm9ybUdyb3VwLnBhdGNoVmFsdWUoe1xuXHRcdFx0cHJvcGVydGllczogT2JqZWN0LmFzc2lnbih7fSwgdGhpcy5kZWZhdWx0UHJvcGVydGllcywgdGhpcy5jb25maWd1cmF0aW9uLmlucHV0cyksXG5cdFx0XHRjb250ZW50OiB0aGlzLmRlZmF1bHRDb250ZW50LFxuXHRcdH0pO1xuXHR9XG5cblx0cHJvdGVjdGVkIGlzRGVmYXVsdFN0YXRlKCk6IGJvb2xlYW4ge1xuXHRcdGlmICghdGhpcy5mb3JtR3JvdXApIHtcblx0XHRcdHJldHVybiBmYWxzZTtcblx0XHR9XG5cblx0XHRyZXR1cm4gKFxuXHRcdFx0aXNTYW1lT2JqZWN0KHRoaXMuZm9ybUdyb3VwLnZhbHVlLnByb3BlcnRpZXMgPz8ge30sIHRoaXMuZGVmYXVsdFZhbHVlcyA/PyB7fSkgJiZcblx0XHRcdGlzU2FtZU9iamVjdCh0aGlzLmZvcm1Hcm91cC52YWx1ZS5jb250ZW50ID8/IHt9LCB0aGlzLmRlZmF1bHRDb250ZW50ID8/IHt9KVxuXHRcdCk7XG5cdH1cblxuXHRwcml2YXRlIGdldFByb3BlcnRpZXNGb3JtVmFsdWVzKCk6IFJlY29yZDxzdHJpbmcsIHVua25vd24+IHtcblx0XHRjb25zdCBmb3JtVmFsdWVzOiBSZWNvcmQ8c3RyaW5nLCB1bmtub3duPiA9IG9iamVjdEtleXModGhpcy5wcm9wZXJ0aWVzID8/IHt9KS5yZWR1Y2UoXG5cdFx0XHQoY29udHJvbHM6IFJlY29yZDxzdHJpbmcsIHVua25vd24+LCBrZXk6IHN0cmluZykgPT4ge1xuXHRcdFx0XHRpZiAodGhpcy5wcm9wZXJ0aWVzKSB7XG5cdFx0XHRcdFx0Y29udHJvbHNba2V5XSA9IHRoaXMuZGVmYXVsdFZhbHVlcyA/IHRoaXMuZGVmYXVsdFZhbHVlc1trZXldIDogdW5kZWZpbmVkO1xuXHRcdFx0XHR9XG5cblx0XHRcdFx0cmV0dXJuIGNvbnRyb2xzO1xuXHRcdFx0fSxcblx0XHRcdHt9IGFzIFJlY29yZDxzdHJpbmcsIHVua25vd24+LFxuXHRcdCk7XG5cblx0XHRyZXR1cm4gT2JqZWN0LmFzc2lnbih7fSwgZm9ybVZhbHVlcywgdGhpcy5jb25maWd1cmF0aW9uLmRlZmF1bHRzKTtcblx0fVxuXG5cdHByaXZhdGUgZ2V0Q29udGVudEZvcm1WYWx1ZXMoKTogUmVjb3JkPHN0cmluZywgYm9vbGVhbj4ge1xuXHRcdHJldHVybiBvYmplY3RLZXlzKHRoaXMuY29uZmlndXJhdGlvbj8uY29udGVudCA/PyB7fSkucmVkdWNlKFxuXHRcdFx0KGNvbnRyb2xzOiBSZWNvcmQ8c3RyaW5nLCBib29sZWFuPiwga2V5OiBzdHJpbmcpID0+IHtcblx0XHRcdFx0aWYgKHRoaXMuY29uZmlndXJhdGlvbj8uY29udGVudCkge1xuXHRcdFx0XHRcdGNvbnRyb2xzW2tleV0gPSBmYWxzZTtcblx0XHRcdFx0fVxuXG5cdFx0XHRcdHJldHVybiBjb250cm9scztcblx0XHRcdH0sXG5cdFx0XHR7fSBhcyBSZWNvcmQ8a2V5b2YgVCwgYm9vbGVhbj4sXG5cdFx0KTtcblx0fVxuXG5cdHJlc2V0Rm9ybSgpOiB2b2lkIHtcblx0XHR0aGlzLmZvcm1Hcm91cC5yZXNldCh7fSwgeyBlbWl0RXZlbnQ6IGZhbHNlIH0pO1xuXHRcdHRoaXMuZm9ybUdyb3VwPy5wYXRjaFZhbHVlKHtcblx0XHRcdHByb3BlcnRpZXM6IHRoaXMuZGVmYXVsdFByb3BlcnRpZXMsXG5cdFx0XHRjb250ZW50OiB0aGlzLmRlZmF1bHRDb250ZW50LFxuXHRcdH0pO1xuXHR9XG59XG4iLCI8bmctY29udGFpbmVyICpuZ0lmPVwiY29uZmlndXJhdGlvblwiPlxuXHQ8bmctZG9jLXBsYXlncm91bmQtcHJvcGVydGllc1xuXHRcdFtmb3JtXT1cImZvcm1Hcm91cFwiXG5cdFx0W3Byb3BlcnRpZXNdPVwicHJvcGVydGllc1wiXG5cdFx0W2lnbm9yZUlucHV0c109XCJjb25maWd1cmF0aW9uLmhpZGRlbklucHV0c1wiXG5cdFx0W2R5bmFtaWNDb250ZW50XT1cImNvbmZpZ3VyYXRpb24uY29udGVudFwiXG5cdFx0W2hpZGVTaWRlUGFuZWxdPVwiY29uZmlndXJhdGlvbi5oaWRlU2lkZVBhbmVsID8/IGZhbHNlXCJcblx0XHRbZGVmYXVsdFZhbHVlc109XCJkZWZhdWx0VmFsdWVzXCJcblx0XHRbc2hvd1Jlc2V0QnV0dG9uXT1cIiFpc0RlZmF1bHRTdGF0ZSgpXCJcblx0XHRbKHJlY3JlYXRlRGVtbyldPVwicmVjcmVhdGVEZW1vXCJcblx0XHQocmVzZXRGb3JtKT1cInJlc2V0Rm9ybSgpXCI+XG5cdFx0PG5nLWRvYy1wbGF5Z3JvdW5kLWRlbW9cblx0XHRcdCpuZ0Zvcj1cImxldCBzZWxlY3RvciBvZiBjb25maWd1cmF0aW9uLnNlbGVjdG9ycyA/PyBzZWxlY3RvcnMgfCBhc0FycmF5XCJcblx0XHRcdFtpZF09XCJpZFwiXG5cdFx0XHRbc2VsZWN0b3JdPVwic2VsZWN0b3JcIlxuXHRcdFx0W3Byb3BlcnRpZXNdPVwicHJvcGVydGllc1wiXG5cdFx0XHRbY29uZmlndXJhdGlvbl09XCJjb25maWd1cmF0aW9uXCJcblx0XHRcdFtyZWNyZWF0ZURlbW9dPVwicmVjcmVhdGVEZW1vXCJcblx0XHRcdFtmb3JtXT1cImZvcm1Hcm91cFwiXG5cdFx0XHRbZXhwYW5kZWRdPVwiY29uZmlndXJhdGlvbi5leHBhbmRlZCA/PyBmYWxzZVwiPlxuXHRcdDwvbmctZG9jLXBsYXlncm91bmQtZGVtbz5cblxuXHRcdDxuZy1kb2MtcGxheWdyb3VuZC1kZW1vXG5cdFx0XHQqbmdJZj1cInBpcGVOYW1lXCJcblx0XHRcdFtpZF09XCJpZFwiXG5cdFx0XHRbcGlwZU5hbWVdPVwicGlwZU5hbWVcIlxuXHRcdFx0W3Byb3BlcnRpZXNdPVwicHJvcGVydGllc1wiXG5cdFx0XHRbY29uZmlndXJhdGlvbl09XCJjb25maWd1cmF0aW9uXCJcblx0XHRcdFtyZWNyZWF0ZURlbW9dPVwicmVjcmVhdGVEZW1vXCJcblx0XHRcdFtmb3JtXT1cImZvcm1Hcm91cFwiPlxuXHRcdDwvbmctZG9jLXBsYXlncm91bmQtZGVtbz5cblx0PC9uZy1kb2MtcGxheWdyb3VuZC1wcm9wZXJ0aWVzPlxuPC9uZy1jb250YWluZXI+XG4iXX0=