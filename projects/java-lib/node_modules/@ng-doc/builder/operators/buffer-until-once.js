"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.bufferUntilOnce = bufferUntilOnce;
const operators_1 = require("rxjs/operators");
/**
 *
 * @param until
 */
function bufferUntilOnce(until) {
    let buffer = [];
    const sharedUntil = until.pipe((0, operators_1.shareReplay)(1));
    return (source) => source.pipe((0, operators_1.tap)((v) => buffer.push(v)), (0, operators_1.startWith)(null), (0, operators_1.switchMap)(() => sharedUntil.pipe((0, operators_1.map)(() => buffer), (0, operators_1.tap)(() => (buffer = [])))));
}
//# sourceMappingURL=buffer-until-once.js.map