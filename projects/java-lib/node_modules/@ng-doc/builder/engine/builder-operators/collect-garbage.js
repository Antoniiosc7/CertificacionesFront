"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.collectGarbage = collectGarbage;
const operators_1 = require("rxjs/operators");
/**
 * Operator that collects garbage from the entity store after each source emission.
 * @param store - The entity store.
 */
function collectGarbage(store) {
    return (source) => source.pipe((0, operators_1.tap)(() => {
        store.asArray().forEach((entity) => {
            if (entity.destroyed) {
                entity.removeArtifacts();
                store.delete(entity.id);
            }
        });
    }));
}
//# sourceMappingURL=collect-garbage.js.map