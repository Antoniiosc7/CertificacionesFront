{"version":3,"file":"ng-doc-ui-kit-components-overlay-container.mjs","sources":["../../../../libs/ui-kit/components/overlay-container/overlay-container.component.ts","../../../../libs/ui-kit/components/overlay-container/overlay-container.component.html","../../../../libs/ui-kit/components/overlay-container/ng-doc-ui-kit-components-overlay-container.ts"],"sourcesContent":["import { AnimationBuilder, AnimationMetadata, AnimationPlayer } from '@angular/animations';\nimport {\n\tConnectedOverlayPositionChange,\n\tFlexibleConnectedPositionStrategy,\n} from '@angular/cdk/overlay';\nimport { DOCUMENT } from '@angular/common';\nimport {\n\tChangeDetectionStrategy,\n\tChangeDetectorRef,\n\tComponent,\n\tElementRef,\n\tHostBinding,\n\tInject,\n\tNgZone,\n\tOnDestroy,\n\tOnInit,\n\tViewChild,\n} from '@angular/core';\nimport { NgDocFocusControlComponent } from '@ng-doc/ui-kit/components/focus-control';\nimport { NgDocOverlayPointerComponent } from '@ng-doc/ui-kit/components/overlay-pointer';\nimport { NgDocEventSwitcherDirective } from '@ng-doc/ui-kit/directives/event-switcher';\nimport { NgDocFocusCatcherDirective } from '@ng-doc/ui-kit/directives/focus-catcher';\nimport { toElement } from '@ng-doc/ui-kit/helpers';\nimport { NgDocOverlayConfig, NgDocOverlayContainer } from '@ng-doc/ui-kit/interfaces';\nimport { ngDocZoneOptimize } from '@ng-doc/ui-kit/observables';\nimport {\n\tNgDocContent,\n\tNgDocHorizontalAlign,\n\tNgDocOverlayAnimationEvent,\n\tNgDocOverlayPosition,\n\tNgDocOverlayRelativePosition,\n\tNgDocVerticalAlign,\n} from '@ng-doc/ui-kit/types';\nimport { NgDocFocusUtils, NgDocOverlayUtils } from '@ng-doc/ui-kit/utils';\nimport { PolymorpheusModule, PolymorpheusOutletDirective } from '@tinkoff/ng-polymorpheus';\nimport { Observable, Subject } from 'rxjs';\nimport { distinctUntilChanged } from 'rxjs/operators';\n\n@Component({\n\tselector: 'ng-doc-overlay-container',\n\ttemplateUrl: './overlay-container.component.html',\n\tstyleUrls: ['./overlay-container.component.scss'],\n\tchangeDetection: ChangeDetectionStrategy.OnPush,\n\tstandalone: true,\n\timports: [\n\t\tNgDocOverlayPointerComponent,\n\t\tNgDocEventSwitcherDirective,\n\t\tNgDocFocusControlComponent,\n\t\tNgDocFocusCatcherDirective,\n\t\tPolymorpheusModule,\n\t],\n})\nexport class NgDocOverlayContainerComponent implements NgDocOverlayContainer, OnInit, OnDestroy {\n\t@ViewChild('contentContainer', { read: ElementRef, static: true })\n\tcontentContainer?: ElementRef<HTMLElement>;\n\n\t@ViewChild(NgDocFocusCatcherDirective)\n\tfocusCatcher?: NgDocFocusCatcherDirective;\n\n\t@ViewChild(PolymorpheusOutletDirective, { static: true })\n\toutlet?: PolymorpheusOutletDirective<object>;\n\n\t@HostBinding('attr.data-ng-doc-overlay-position')\n\trelativePosition: NgDocOverlayRelativePosition | null = null;\n\n\tconfig?: NgDocOverlayConfig;\n\tcontent: NgDocContent = '';\n\n\tprivate currentPosition?: NgDocOverlayPosition;\n\tprivate animationEvent$: Subject<NgDocOverlayAnimationEvent> =\n\t\tnew Subject<NgDocOverlayAnimationEvent>();\n\tprivate isOpened: boolean = true;\n\n\tconstructor(\n\t\tprivate elementRef: ElementRef<HTMLElement>,\n\t\t@Inject(DOCUMENT) private documentRef: Document,\n\t\tprivate changeDetectorRef: ChangeDetectorRef,\n\t\tprivate ngZone: NgZone,\n\t\tprivate animationBuilder: AnimationBuilder,\n\t) {}\n\n\tngOnInit(): void {\n\t\tthis.runAnimation(this.config?.openAnimation || []);\n\t\tif (this.config?.positionStrategy instanceof FlexibleConnectedPositionStrategy) {\n\t\t\tthis.config.positionStrategy.positionChanges\n\t\t\t\t.pipe(\n\t\t\t\t\tdistinctUntilChanged(\n\t\t\t\t\t\t(a: ConnectedOverlayPositionChange, b: ConnectedOverlayPositionChange) =>\n\t\t\t\t\t\t\ta.connectionPair === b.connectionPair,\n\t\t\t\t\t),\n\t\t\t\t\tngDocZoneOptimize(this.ngZone),\n\t\t\t\t)\n\t\t\t\t.subscribe((change: ConnectedOverlayPositionChange) => {\n\t\t\t\t\tthis.currentPosition = NgDocOverlayUtils.getOverlayPosition(change.connectionPair);\n\t\t\t\t\tthis.relativePosition = NgDocOverlayUtils.getRelativePosition(this.currentPosition);\n\t\t\t\t\tthis.changeDetectorRef.markForCheck();\n\t\t\t\t});\n\t\t}\n\t}\n\n\t@HostBinding('attr.data-ng-doc-overlay-with-contact-border')\n\tget contactBorder(): boolean {\n\t\treturn !!this.config?.contactBorder;\n\t}\n\n\tget isFocused(): boolean {\n\t\treturn !!this.focusCatcher?.focused;\n\t}\n\n\tget animationEvent(): Observable<NgDocOverlayAnimationEvent> {\n\t\treturn this.animationEvent$.asObservable();\n\t}\n\n\tget overlayAlign(): NgDocHorizontalAlign | NgDocVerticalAlign | null {\n\t\treturn this.currentPosition\n\t\t\t? NgDocOverlayUtils.getPositionAlign(\n\t\t\t\t\tNgDocOverlayUtils.toConnectedPosition(this.currentPosition),\n\t\t\t  )\n\t\t\t: null;\n\t}\n\n\tclose(): void {\n\t\tif (this.isOpened) {\n\t\t\tthis.runAnimation(this.config?.closeAnimation || [], true);\n\t\t\tthis.isOpened = false;\n\t\t\tthis.changeDetectorRef.markForCheck();\n\t\t}\n\t}\n\n\tfocus(): void {\n\t\tif (this.contentContainer) {\n\t\t\tNgDocFocusUtils.focusClosestElement(\n\t\t\t\ttoElement(this.contentContainer),\n\t\t\t\ttoElement(this.contentContainer),\n\t\t\t);\n\t\t}\n\t}\n\n\tmarkForCheck(): void {\n\t\tthis.changeDetectorRef.markForCheck();\n\t}\n\n\tprivate runAnimation(animation: AnimationMetadata[], close: boolean = false): void {\n\t\tconst player: AnimationPlayer = this.animationBuilder\n\t\t\t.build(animation)\n\t\t\t.create(this.elementRef.nativeElement);\n\t\tplayer.onStart(() => this.animationEvent$.next(close ? 'beforeClose' : 'beforeOpen'));\n\t\tplayer.onDone(() => this.animationEvent$.next(close ? 'afterClose' : 'afterOpen'));\n\t\tplayer.play();\n\t}\n\n\tngOnDestroy(): void {\n\t\tif (this.isFocused && this.config && this.config.viewContainerRef) {\n\t\t\tNgDocFocusUtils.focusClosestElement(\n\t\t\t\tthis.config.viewContainerRef.element.nativeElement,\n\t\t\t\tthis.documentRef.body,\n\t\t\t\tfalse,\n\t\t\t);\n\t\t}\n\t}\n}\n","<ng-doc-overlay-pointer\n\t[overlayPosition]=\"relativePosition\"\n\t[overlayAlign]=\"overlayAlign\"\n\t[withPointer]=\"!!config?.withPointer\"\n\t[ngDocEventSwitcher]=\"config?.viewContainerRef?.element?.nativeElement ?? null\"\n\t[events]=\"['focusin', 'focusout', 'keydown', 'scroll']\">\n\t<ng-doc-focus-control\n\t\t[focusHost]=\"this.config?.viewContainerRef?.element?.nativeElement ?? null\"\n\t\tngDocFocusCatcher>\n\t\t<div class=\"ng-doc-overlay-content\" [tabIndex]=\"-1\" #contentContainer>\n\t\t\t<ng-container *polymorpheusOutlet=\"content as text\">{{ text }}</ng-container>\n\t\t</div>\n\t</ng-doc-focus-control>\n</ng-doc-overlay-pointer>\n","/**\n * Generated bundle index. Do not edit.\n */\n\nexport * from './index';\n"],"names":[],"mappings":"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"}