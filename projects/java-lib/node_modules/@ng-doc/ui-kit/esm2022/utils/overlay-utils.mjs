import { asArray } from '@ng-doc/core/helpers/as-array';
export const NG_DOC_ARROW_MARGIN = 32;
const POSITION_DESCRIPTION = {
    'top-left': {
        originX: 'start',
        originY: 'top',
        overlayX: 'start',
        overlayY: 'bottom',
    },
    'top-center': {
        originX: 'center',
        originY: 'top',
        overlayX: 'center',
        overlayY: 'bottom',
    },
    'top-right': {
        originX: 'end',
        originY: 'top',
        overlayX: 'end',
        overlayY: 'bottom',
    },
    'bottom-left': {
        originX: 'start',
        originY: 'bottom',
        overlayX: 'start',
        overlayY: 'top',
    },
    'bottom-center': {
        originX: 'center',
        originY: 'bottom',
        overlayX: 'center',
        overlayY: 'top',
    },
    'bottom-right': {
        originX: 'end',
        originY: 'bottom',
        overlayX: 'end',
        overlayY: 'top',
    },
    'left-top': {
        originX: 'start',
        originY: 'top',
        overlayX: 'end',
        overlayY: 'top',
    },
    'left-center': {
        originX: 'start',
        originY: 'center',
        overlayX: 'end',
        overlayY: 'center',
    },
    'left-bottom': {
        originX: 'start',
        originY: 'bottom',
        overlayX: 'end',
        overlayY: 'bottom',
    },
    'right-top': {
        originX: 'end',
        originY: 'top',
        overlayX: 'start',
        overlayY: 'top',
    },
    'right-center': {
        originX: 'end',
        originY: 'center',
        overlayX: 'start',
        overlayY: 'center',
    },
    'right-bottom': {
        originX: 'end',
        originY: 'bottom',
        overlayX: 'start',
        overlayY: 'bottom',
    },
};
export class NgDocOverlayUtils {
    static getConnectedPosition(dropdownPositions, origin, offset = 0, withPointer = false) {
        return asArray(dropdownPositions).map((position) => {
            const connectedPosition = NgDocOverlayUtils.toConnectedPosition(position);
            const marginMultiplier = NgDocOverlayUtils.getMarginMultiplier(connectedPosition);
            const marginX = !NgDocOverlayUtils.isVerticalPosition(connectedPosition)
                ? offset * marginMultiplier
                : 0;
            const marginY = NgDocOverlayUtils.isVerticalPosition(connectedPosition)
                ? offset * marginMultiplier
                : 0;
            connectedPosition.offsetX = connectedPosition.offsetX || 0;
            connectedPosition.offsetY = connectedPosition.offsetY || 0;
            connectedPosition.offsetX +=
                (withPointer ? NgDocOverlayUtils.getOffsetX(origin, connectedPosition) : 0) + marginX;
            connectedPosition.offsetY +=
                (withPointer ? NgDocOverlayUtils.getOffsetY(origin, connectedPosition) : 0) + marginY;
            return connectedPosition;
        });
    }
    static toConnectedPosition(position) {
        return typeof position === 'string' ? { ...POSITION_DESCRIPTION[position] } : { ...position };
    }
    static toConnectedPositions(positions) {
        return positions.map(NgDocOverlayUtils.toConnectedPosition);
    }
    static getOffsetX(origin, position) {
        const isVertical = NgDocOverlayUtils.isVerticalPosition(position);
        const offsetMultiplier = NgDocOverlayUtils.getOffsetMultiplier(position);
        const isCenter = NgDocOverlayUtils.isCenterPosition(position);
        const width = (position.originX === 'center' && position.overlayX !== 'center') ||
            NgDocOverlayUtils.overlayIsOutByX(position)
            ? NG_DOC_ARROW_MARGIN - 24
            : origin.offsetWidth;
        return ((isVertical && !isCenter ? Math.max(NG_DOC_ARROW_MARGIN - width, 0) : 0) * offsetMultiplier);
    }
    static getOffsetY(origin, position) {
        const isVertical = NgDocOverlayUtils.isVerticalPosition(position);
        const offsetMultiplier = NgDocOverlayUtils.getOffsetMultiplier(position);
        const isCenter = NgDocOverlayUtils.isCenterPosition(position);
        const height = (position.originY === 'center' && position.overlayY !== 'center') ||
            NgDocOverlayUtils.overlayIsOutByY(position)
            ? NG_DOC_ARROW_MARGIN - 24
            : origin.offsetHeight;
        return ((!isVertical && !isCenter ? Math.max(NG_DOC_ARROW_MARGIN - height, 0) : 0) * offsetMultiplier);
    }
    static overlayIsOutByX(position) {
        return ((position.originX === 'start' && position.overlayX === 'end') ||
            (position.originX === 'end' && position.overlayX === 'start'));
    }
    static overlayIsOutByY(position) {
        return ((position.originY === 'top' && position.overlayY === 'bottom') ||
            (position.originY === 'bottom' && position.overlayY === 'top'));
    }
    static getOffsetMultiplier(position) {
        return (NgDocOverlayUtils.isVerticalPosition(position) && position.overlayX === 'end') ||
            (!NgDocOverlayUtils.isVerticalPosition(position) && position.overlayY === 'bottom')
            ? 1
            : -1;
    }
    static getMarginMultiplier(position) {
        return ['right', 'bottom'].includes(NgDocOverlayUtils.getRelativePosition(position) || '')
            ? 1
            : -1;
    }
    static isVerticalPosition(position) {
        return ['bottom', 'top'].includes(NgDocOverlayUtils.getRelativePosition(position) || '');
    }
    static isCenterPosition(position) {
        return position.overlayX === 'center' || position.overlayY === 'center';
    }
    static getPositionAlign(position) {
        if (NgDocOverlayUtils.isVerticalPosition(position)) {
            return position.overlayX === 'start' ? 'left' : position.overlayX === 'end' ? 'right' : null;
        }
        else {
            return position.originY === 'top' ? 'top' : position.originY === 'bottom' ? 'bottom' : null;
        }
    }
    static getRelativePosition(pos) {
        const position = NgDocOverlayUtils.toConnectedPosition(pos);
        if (position.originY === 'bottom' && position.overlayY === 'top') {
            return 'bottom';
        }
        if (position.originY === 'top' && position.overlayY === 'bottom') {
            return 'top';
        }
        if (position.originX === 'start' && position.overlayX === 'end') {
            return 'left';
        }
        if (position.originX === 'end' && position.overlayX === 'start') {
            return 'right';
        }
        return null;
    }
    static getOverlayPosition(positionPair) {
        const existsPosition = Object.keys(POSITION_DESCRIPTION).find((key) => {
            const positionDescription = POSITION_DESCRIPTION[key];
            return (positionPair.originX === positionDescription.originX &&
                positionPair.originY === positionDescription.originY &&
                positionPair.overlayX === positionDescription.overlayX &&
                positionPair.overlayY === positionDescription.overlayY);
        });
        return existsPosition ? existsPosition : positionPair;
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoib3ZlcmxheS11dGlscy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL2xpYnMvdWkta2l0L3V0aWxzL292ZXJsYXktdXRpbHMudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQ0EsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNLCtCQUErQixDQUFDO0FBUXhELE1BQU0sQ0FBQyxNQUFNLG1CQUFtQixHQUFXLEVBQUUsQ0FBQztBQUU5QyxNQUFNLG9CQUFvQixHQUFzQztJQUMvRCxVQUFVLEVBQUU7UUFDWCxPQUFPLEVBQUUsT0FBTztRQUNoQixPQUFPLEVBQUUsS0FBSztRQUNkLFFBQVEsRUFBRSxPQUFPO1FBQ2pCLFFBQVEsRUFBRSxRQUFRO0tBQ2xCO0lBQ0QsWUFBWSxFQUFFO1FBQ2IsT0FBTyxFQUFFLFFBQVE7UUFDakIsT0FBTyxFQUFFLEtBQUs7UUFDZCxRQUFRLEVBQUUsUUFBUTtRQUNsQixRQUFRLEVBQUUsUUFBUTtLQUNsQjtJQUNELFdBQVcsRUFBRTtRQUNaLE9BQU8sRUFBRSxLQUFLO1FBQ2QsT0FBTyxFQUFFLEtBQUs7UUFDZCxRQUFRLEVBQUUsS0FBSztRQUNmLFFBQVEsRUFBRSxRQUFRO0tBQ2xCO0lBQ0QsYUFBYSxFQUFFO1FBQ2QsT0FBTyxFQUFFLE9BQU87UUFDaEIsT0FBTyxFQUFFLFFBQVE7UUFDakIsUUFBUSxFQUFFLE9BQU87UUFDakIsUUFBUSxFQUFFLEtBQUs7S0FDZjtJQUNELGVBQWUsRUFBRTtRQUNoQixPQUFPLEVBQUUsUUFBUTtRQUNqQixPQUFPLEVBQUUsUUFBUTtRQUNqQixRQUFRLEVBQUUsUUFBUTtRQUNsQixRQUFRLEVBQUUsS0FBSztLQUNmO0lBQ0QsY0FBYyxFQUFFO1FBQ2YsT0FBTyxFQUFFLEtBQUs7UUFDZCxPQUFPLEVBQUUsUUFBUTtRQUNqQixRQUFRLEVBQUUsS0FBSztRQUNmLFFBQVEsRUFBRSxLQUFLO0tBQ2Y7SUFDRCxVQUFVLEVBQUU7UUFDWCxPQUFPLEVBQUUsT0FB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QUFDLFFBQVEsS0FBSyxtQkFBbUIsQ0FBQyxRQUFRO2dCQUN0RCxZQUFZLENBQUMsUUFBUSxLQUFLLG1CQUFtQixDQUFDLFFBQVEsQ0FDdEQsQ0FBQztRQUNILENBQUMsQ0FDdUIsQ0FBQztRQUMxQixPQUFPLGNBQWMsQ0FBQyxDQUFDLENBQUMsY0FBYyxDQUFDLENBQUMsQ0FBQyxZQUFZLENBQUM7SUFDdkQsQ0FBQztDQUNEIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgQ29ubmVjdGVkUG9zaXRpb24sIENvbm5lY3Rpb25Qb3NpdGlvblBhaXIgfSBmcm9tICdAYW5ndWxhci9jZGsvb3ZlcmxheSc7XG5pbXBvcnQgeyBhc0FycmF5IH0gZnJvbSAnQG5nLWRvYy9jb3JlL2hlbHBlcnMvYXMtYXJyYXknO1xuaW1wb3J0IHtcblx0TmdEb2NIb3Jpem9udGFsQWxpZ24sXG5cdE5nRG9jT3ZlcmxheVBvc2l0aW9uLFxuXHROZ0RvY092ZXJsYXlSZWxhdGl2ZVBvc2l0aW9uLFxuXHROZ0RvY1ZlcnRpY2FsQWxpZ24sXG59IGZyb20gJ0BuZy1kb2MvdWkta2l0L3R5cGVzJztcblxuZXhwb3J0IGNvbnN0IE5HX0RPQ19BUlJPV19NQVJHSU46IG51bWJlciA9IDMyO1xuXG5jb25zdCBQT1NJVElPTl9ERVNDUklQVElPTjogUmVjb3JkPHN0cmluZywgQ29ubmVjdGVkUG9zaXRpb24+ID0ge1xuXHQndG9wLWxlZnQnOiB7XG5cdFx0b3JpZ2luWDogJ3N0YXJ0Jyxcblx0XHRvcmlnaW5ZOiAndG9wJyxcblx0XHRvdmVybGF5WDogJ3N0YXJ0Jyxcblx0XHRvdmVybGF5WTogJ2JvdHRvbScsXG5cdH0sXG5cdCd0b3AtY2VudGVyJzoge1xuXHRcdG9yaWdpblg6ICdjZW50ZXInLFxuXHRcdG9yaWdpblk6ICd0b3AnLFxuXHRcdG92ZXJsYXlYOiAnY2VudGVyJyxcblx0XHRvdmVybGF5WTogJ2JvdHRvbScsXG5cdH0sXG5cdCd0b3AtcmlnaHQnOiB7XG5cdFx0b3JpZ2luWDogJ2VuZCcsXG5cdFx0b3JpZ2luWTogJ3RvcCcsXG5cdFx0b3ZlcmxheVg6ICdlbmQnLFxuXHRcdG92ZXJsYXlZOiAnYm90dG9tJyxcblx0fSxcblx0J2JvdHRvbS1sZWZ0Jzoge1xuXHRcdG9yaWdpblg6ICdzdGFydCcsXG5cdFx0b3JpZ2luWTogJ2JvdHRvbScsXG5cdFx0b3ZlcmxheVg6ICdzdGFydCcsXG5cdFx0b3ZlcmxheVk6ICd0b3AnLFxuXHR9LFxuXHQnYm90dG9tLWNlbnRlcic6IHtcblx0XHRvcmlnaW5YOiAnY2VudGVyJyxcblx0XHRvcmlnaW5ZOiAnYm90dG9tJyxcblx0XHRvdmVybGF5WDogJ2NlbnRlcicsXG5cdFx0b3ZlcmxheVk6ICd0b3AnLFxuXHR9LFxuXHQnYm90dG9tLXJpZ2h0Jzoge1xuXHRcdG9yaWdpblg6ICdlbmQnLFxuXHRcdG9yaWdpblk6ICdib3R0b20nLFxuXHRcdG92ZXJsYXlYOiAnZW5kJyxcblx0XHRvdmVybGF5WTogJ3RvcCcsXG5cdH0sXG5cdCdsZWZ0LXRvcCc6IHtcblx0XHRvcmlnaW5YOiAnc3RhcnQnLFxuXHRcdG9yaWdpblk6ICd0b3AnLFxuXHRcdG92ZXJsYXlYOiAnZW5kJyxcblx0XHRvdmVybGF5WTogJ3RvcCcsXG5cdH0sXG5cdCdsZWZ0LWNlbnRlcic6IHtcblx0XHRvcmlnaW5YOiAnc3RhcnQnLFxuXHRcdG9yaWdpblk6ICdjZW50ZXInLFxuXHRcdG92ZXJsYXlYOiAnZW5kJyxcblx0XHRvdmVybGF5WTogJ2NlbnRlcicsXG5cdH0sXG5cdCdsZWZ0LWJvdHRvbSc6IHtcblx0XHRvcmlnaW5YOiAnc3RhcnQnLFxuXHRcdG9yaWdpblk6ICdib3R0b20nLFxuXHRcdG92ZXJsYXlYOiAnZW5kJyxcblx0XHRvdmVybGF5WTogJ2JvdHRvbScsXG5cdH0sXG5cdCdyaWdodC10b3AnOiB7XG5cdFx0b3JpZ2luWDogJ2VuZCcsXG5cdFx0b3JpZ2luWTogJ3RvcCcsXG5cdFx0b3ZlcmxheVg6ICdzdGFydCcsXG5cdFx0b3ZlcmxheVk6ICd0b3AnLFxuXHR9LFxuXHQncmlnaHQtY2VudGVyJzoge1xuXHRcdG9yaWdpblg6ICdlbmQnLFxuXHRcdG9yaWdpblk6ICdjZW50ZXInLFxuXHRcdG92ZXJsYXlYOiAnc3RhcnQnLFxuXHRcdG92ZXJsYXlZOiAnY2VudGVyJyxcblx0fSxcblx0J3JpZ2h0LWJvdHRvbSc6IHtcblx0XHRvcmlnaW5YOiAnZW5kJyxcblx0XHRvcmlnaW5ZOiAnYm90dG9tJyxcblx0XHRvdmVybGF5WDogJ3N0YXJ0Jyxcblx0XHRvdmVybGF5WTogJ2JvdHRvbScsXG5cdH0sXG59O1xuXG5leHBvcnQgY2xhc3MgTmdEb2NPdmVybGF5VXRpbHMge1xuXHRzdGF0aWMgZ2V0Q29ubmVjdGVkUG9zaXRpb24oXG5cdFx0ZHJvcGRvd25Qb3NpdGlvbnM6IE5nRG9jT3ZlcmxheVBvc2l0aW9uIHwgTmdEb2NPdmVybGF5UG9zaXRpb25bXSxcblx0XHRvcmlnaW46IEhUTUxFbGVtZW50LFxuXHRcdG9mZnNldDogbnVtYmVyID0gMCxcblx0XHR3aXRoUG9pbnRlcjogYm9vbGVhbiA9IGZhbHNlLFxuXHQpOiBDb25uZWN0ZWRQb3NpdGlvbltdIHtcblx0XHRyZXR1cm4gYXNBcnJheShkcm9wZG93blBvc2l0aW9ucykubWFwKChwb3NpdGlvbjogTmdEb2NPdmVybGF5UG9zaXRpb24pID0+IHtcblx0XHRcdGNvbnN0IGNvbm5lY3RlZFBvc2l0aW9uOiBDb25uZWN0ZWRQb3NpdGlvbiA9IE5nRG9jT3ZlcmxheVV0aWxzLnRvQ29ubmVjdGVkUG9zaXRpb24ocG9zaXRpb24pO1xuXHRcdFx0Y29uc3QgbWFyZ2luTXVsdGlwbGllcjogbnVtYmVyID0gTmdEb2NPdmVybGF5VXRpbHMuZ2V0TWFyZ2luTXVsdGlwbGllcihjb25uZWN0ZWRQb3NpdGlvbik7XG5cdFx0XHRjb25zdCBtYXJnaW5YOiBudW1iZXIgPSAhTmdEb2NPdmVybGF5VXRpbHMuaXNWZXJ0aWNhbFBvc2l0aW9uKGNvbm5lY3RlZFBvc2l0aW9uKVxuXHRcdFx0XHQ/IG9mZnNldCAqIG1hcmdpbk11bHRpcGxpZXJcblx0XHRcdFx0OiAwO1xuXHRcdFx0Y29uc3QgbWFyZ2luWTogbnVtYmVyID0gTmdEb2NPdmVybGF5VXRpbHMuaXNWZXJ0aWNhbFBvc2l0aW9uKGNvbm5lY3RlZFBvc2l0aW9uKVxuXHRcdFx0XHQ/IG9mZnNldCAqIG1hcmdpbk11bHRpcGxpZXJcblx0XHRcdFx0OiAwO1xuXHRcdFx0Y29ubmVjdGVkUG9zaXRpb24ub2Zmc2V0WCA9IGNvbm5lY3RlZFBvc2l0aW9uLm9mZnNldFggfHwgMDtcblx0XHRcdGNvbm5lY3RlZFBvc2l0aW9uLm9mZnNldFkgPSBjb25uZWN0ZWRQb3NpdGlvbi5vZmZzZXRZIHx8IDA7XG5cdFx0XHRjb25uZWN0ZWRQb3NpdGlvbi5vZmZzZXRYICs9XG5cdFx0XHRcdCh3aXRoUG9pbnRlciA/IE5nRG9jT3ZlcmxheVV0aWxzLmdldE9mZnNldFgob3JpZ2luLCBjb25uZWN0ZWRQb3NpdGlvbikgOiAwKSArIG1hcmdpblg7XG5cdFx0XHRjb25uZWN0ZWRQb3NpdGlvbi5vZmZzZXRZICs9XG5cdFx0XHRcdCh3aXRoUG9pbnRlciA/IE5nRG9jT3ZlcmxheVV0aWxzLmdldE9mZnNldFkob3JpZ2luLCBjb25uZWN0ZWRQb3NpdGlvbikgOiAwKSArIG1hcmdpblk7XG5cdFx0XHRyZXR1cm4gY29ubmVjdGVkUG9zaXRpb247XG5cdFx0fSk7XG5cdH1cblxuXHRzdGF0aWMgdG9Db25uZWN0ZWRQb3NpdGlvbihwb3NpdGlvbjogTmdEb2NPdmVybGF5UG9zaXRpb24pOiBDb25uZWN0ZWRQb3NpdGlvbiB7XG5cdFx0cmV0dXJuIHR5cGVvZiBwb3NpdGlvbiA9PT0gJ3N0cmluZycgPyB7IC4uLlBPU0lUSU9OX0RFU0NSSVBUSU9OW3Bvc2l0aW9uXSB9IDogeyAuLi5wb3NpdGlvbiB9O1xuXHR9XG5cblx0c3RhdGljIHRvQ29ubmVjdGVkUG9zaXRpb25zKHBvc2l0aW9uczogTmdEb2NPdmVybGF5UG9zaXRpb25bXSk6IENvbm5lY3RlZFBvc2l0aW9uW10ge1xuXHRcdHJldHVybiBwb3NpdGlvbnMubWFwKE5nRG9jT3ZlcmxheVV0aWxzLnRvQ29ubmVjdGVkUG9zaXRpb24pO1xuXHR9XG5cblx0c3RhdGljIGdldE9mZnNldFgob3JpZ2luOiBIVE1MRWxlbWVudCwgcG9zaXRpb246IENvbm5lY3RlZFBvc2l0aW9uKTogbnVtYmVyIHtcblx0XHRjb25zdCBpc1ZlcnRpY2FsOiBib29sZWFuID0gTmdEb2NPdmVybGF5VXRpbHMuaXNWZXJ0aWNhbFBvc2l0aW9uKHBvc2l0aW9uKTtcblx0XHRjb25zdCBvZmZzZXRNdWx0aXBsaWVyOiBudW1iZXIgPSBOZ0RvY092ZXJsYXlVdGlscy5nZXRPZmZzZXRNdWx0aXBsaWVyKHBvc2l0aW9uKTtcblx0XHRjb25zdCBpc0NlbnRlcjogYm9vbGVhbiA9IE5nRG9jT3ZlcmxheVV0aWxzLmlzQ2VudGVyUG9zaXRpb24ocG9zaXRpb24pO1xuXHRcdGNvbnN0IHdpZHRoOiBudW1iZXIgPVxuXHRcdFx0KHBvc2l0aW9uLm9yaWdpblggPT09ICdjZW50ZXInICYmIHBvc2l0aW9uLm92ZXJsYXlYICE9PSAnY2VudGVyJykgfHxcblx0XHRcdE5nRG9jT3ZlcmxheVV0aWxzLm92ZXJsYXlJc091dEJ5WChwb3NpdGlvbilcblx0XHRcdFx0PyBOR19ET0NfQVJST1dfTUFSR0lOIC0gMjRcblx0XHRcdFx0OiBvcmlnaW4ub2Zmc2V0V2lkdGg7XG5cdFx0cmV0dXJuIChcblx0XHRcdChpc1ZlcnRpY2FsICYmICFpc0NlbnRlciA/IE1hdGgubWF4KE5HX0RPQ19BUlJPV19NQVJHSU4gLSB3aWR0aCwgMCkgOiAwKSAqIG9mZnNldE11bHRpcGxpZXJcblx0XHQpO1xuXHR9XG5cblx0c3RhdGljIGdldE9mZnNldFkob3JpZ2luOiBIVE1MRWxlbWVudCwgcG9zaXRpb246IENvbm5lY3RlZFBvc2l0aW9uKTogbnVtYmVyIHtcblx0XHRjb25zdCBpc1ZlcnRpY2FsOiBib29sZWFuID0gTmdEb2NPdmVybGF5VXRpbHMuaXNWZXJ0aWNhbFBvc2l0aW9uKHBvc2l0aW9uKTtcblx0XHRjb25zdCBvZmZzZXRNdWx0aXBsaWVyOiBudW1iZXIgPSBOZ0RvY092ZXJsYXlVdGlscy5nZXRPZmZzZXRNdWx0aXBsaWVyKHBvc2l0aW9uKTtcblx0XHRjb25zdCBpc0NlbnRlcjogYm9vbGVhbiA9IE5nRG9jT3ZlcmxheVV0aWxzLmlzQ2VudGVyUG9zaXRpb24ocG9zaXRpb24pO1xuXHRcdGNvbnN0IGhlaWdodDogbnVtYmVyID1cblx0XHRcdChwb3NpdGlvbi5vcmlnaW5ZID09PSAnY2VudGVyJyAmJiBwb3NpdGlvbi5vdmVybGF5WSAhPT0gJ2NlbnRlcicpIHx8XG5cdFx0XHROZ0RvY092ZXJsYXlVdGlscy5vdmVybGF5SXNPdXRCeVkocG9zaXRpb24pXG5cdFx0XHRcdD8gTkdfRE9DX0FSUk9XX01BUkdJTiAtIDI0XG5cdFx0XHRcdDogb3JpZ2luLm9mZnNldEhlaWdodDtcblx0XHRyZXR1cm4gKFxuXHRcdFx0KCFpc1ZlcnRpY2FsICYmICFpc0NlbnRlciA/IE1hdGgubWF4KE5HX0RPQ19BUlJPV19NQVJHSU4gLSBoZWlnaHQsIDApIDogMCkgKiBvZmZzZXRNdWx0aXBsaWVyXG5cdFx0KTtcblx0fVxuXG5cdHN0YXRpYyBvdmVybGF5SXNPdXRCeVgocG9zaXRpb246IENvbm5lY3RlZFBvc2l0aW9uKTogYm9vbGVhbiB7XG5cdFx0cmV0dXJuIChcblx0XHRcdChwb3NpdGlvbi5vcmlnaW5YID09PSAnc3RhcnQnICYmIHBvc2l0aW9uLm92ZXJsYXlYID09PSAnZW5kJykgfHxcblx0XHRcdChwb3NpdGlvbi5vcmlnaW5YID09PSAnZW5kJyAmJiBwb3NpdGlvbi5vdmVybGF5WCA9PT0gJ3N0YXJ0Jylcblx0XHQpO1xuXHR9XG5cblx0c3RhdGljIG92ZXJsYXlJc091dEJ5WShwb3NpdGlvbjogQ29ubmVjdGVkUG9zaXRpb24pOiBib29sZWFuIHtcblx0XHRyZXR1cm4gKFxuXHRcdFx0KHBvc2l0aW9uLm9yaWdpblkgPT09ICd0b3AnICYmIHBvc2l0aW9uLm92ZXJsYXlZID09PSAnYm90dG9tJykgfHxcblx0XHRcdChwb3NpdGlvbi5vcmlnaW5ZID09PSAnYm90dG9tJyAmJiBwb3NpdGlvbi5vdmVybGF5WSA9PT0gJ3RvcCcpXG5cdFx0KTtcblx0fVxuXG5cdHN0YXRpYyBnZXRPZmZzZXRNdWx0aXBsaWVyKHBvc2l0aW9uOiBDb25uZWN0ZWRQb3NpdGlvbik6IG51bWJlciB7XG5cdFx0cmV0dXJuIChOZ0RvY092ZXJsYXlVdGlscy5pc1ZlcnRpY2FsUG9zaXRpb24ocG9zaXRpb24pICYmIHBvc2l0aW9uLm92ZXJsYXlYID09PSAnZW5kJykgfHxcblx0XHRcdCghTmdEb2NPdmVybGF5VXRpbHMuaXNWZXJ0aWNhbFBvc2l0aW9uKHBvc2l0aW9uKSAmJiBwb3NpdGlvbi5vdmVybGF5WSA9PT0gJ2JvdHRvbScpXG5cdFx0XHQ/IDFcblx0XHRcdDogLTE7XG5cdH1cblxuXHRzdGF0aWMgZ2V0TWFyZ2luTXVsdGlwbGllcihwb3NpdGlvbjogQ29ubmVjdGVkUG9zaXRpb24pOiBudW1iZXIge1xuXHRcdHJldHVybiBbJ3JpZ2h0JywgJ2JvdHRvbSddLmluY2x1ZGVzKE5nRG9jT3ZlcmxheVV0aWxzLmdldFJlbGF0aXZlUG9zaXRpb24ocG9zaXRpb24pIHx8ICcnKVxuXHRcdFx0PyAxXG5cdFx0XHQ6IC0xO1xuXHR9XG5cblx0c3RhdGljIGlzVmVydGljYWxQb3NpdGlvbihwb3NpdGlvbjogQ29ubmVjdGVkUG9zaXRpb24pOiBib29sZWFuIHtcblx0XHRyZXR1cm4gWydib3R0b20nLCAndG9wJ10uaW5jbHVkZXMoTmdEb2NPdmVybGF5VXRpbHMuZ2V0UmVsYXRpdmVQb3NpdGlvbihwb3NpdGlvbikgfHwgJycpO1xuXHR9XG5cblx0c3RhdGljIGlzQ2VudGVyUG9zaXRpb24ocG9zaXRpb246IENvbm5lY3RlZFBvc2l0aW9uKTogYm9vbGVhbiB7XG5cdFx0cmV0dXJuIHBvc2l0aW9uLm92ZXJsYXlYID09PSAnY2VudGVyJyB8fCBwb3NpdGlvbi5vdmVybGF5WSA9PT0gJ2NlbnRlcic7XG5cdH1cblxuXHRzdGF0aWMgZ2V0UG9zaXRpb25BbGlnbihcblx0XHRwb3NpdGlvbjogQ29ubmVjdGVkUG9zaXRpb24sXG5cdCk6IE5nRG9jSG9yaXpvbnRhbEFsaWduIHwgTmdEb2NWZXJ0aWNhbEFsaWduIHwgbnVsbCB7XG5cdFx0aWYgKE5nRG9jT3ZlcmxheVV0aWxzLmlzVmVydGljYWxQb3NpdGlvbihwb3NpdGlvbikpIHtcblx0XHRcdHJldHVybiBwb3NpdGlvbi5vdmVybGF5WCA9PT0gJ3N0YXJ0JyA/ICdsZWZ0JyA6IHBvc2l0aW9uLm92ZXJsYXlYID09PSAnZW5kJyA/ICdyaWdodCcgOiBudWxsO1xuXHRcdH0gZWxzZSB7XG5cdFx0XHRyZXR1cm4gcG9zaXRpb24ub3JpZ2luWSA9PT0gJ3RvcCcgPyAndG9wJyA6IHBvc2l0aW9uLm9yaWdpblkgPT09ICdib3R0b20nID8gJ2JvdHRvbScgOiBudWxsO1xuXHRcdH1cblx0fVxuXG5cdHN0YXRpYyBnZXRSZWxhdGl2ZVBvc2l0aW9uKHBvczogTmdEb2NPdmVybGF5UG9zaXRpb24pOiBOZ0RvY092ZXJsYXlSZWxhdGl2ZVBvc2l0aW9uIHwgbnVsbCB7XG5cdFx0Y29uc3QgcG9zaXRpb246IENvbm5lY3RlZFBvc2l0aW9uID0gTmdEb2NPdmVybGF5VXRpbHMudG9Db25uZWN0ZWRQb3NpdGlvbihwb3MpO1xuXHRcdGlmIChwb3NpdGlvbi5vcmlnaW5ZID09PSAnYm90dG9tJyAmJiBwb3NpdGlvbi5vdmVybGF5WSA9PT0gJ3RvcCcpIHtcblx0XHRcdHJldHVybiAnYm90dG9tJztcblx0XHR9XG5cdFx0aWYgKHBvc2l0aW9uLm9yaWdpblkgPT09ICd0b3AnICYmIHBvc2l0aW9uLm92ZXJsYXlZID09PSAnYm90dG9tJykge1xuXHRcdFx0cmV0dXJuICd0b3AnO1xuXHRcdH1cblx0XHRpZiAocG9zaXRpb24ub3JpZ2luWCA9PT0gJ3N0YXJ0JyAmJiBwb3NpdGlvbi5vdmVybGF5WCA9PT0gJ2VuZCcpIHtcblx0XHRcdHJldHVybiAnbGVmdCc7XG5cdFx0fVxuXHRcdGlmIChwb3NpdGlvbi5vcmlnaW5YID09PSAnZW5kJyAmJiBwb3NpdGlvbi5vdmVybGF5WCA9PT0gJ3N0YXJ0Jykge1xuXHRcdFx0cmV0dXJuICdyaWdodCc7XG5cdFx0fVxuXHRcdHJldHVybiBudWxsO1xuXHR9XG5cblx0c3RhdGljIGdldE92ZXJsYXlQb3NpdGlvbihwb3NpdGlvblBhaXI6IENvbm5lY3Rpb25Qb3NpdGlvblBhaXIpOiBOZ0RvY092ZXJsYXlQb3NpdGlvbiB7XG5cdFx0Y29uc3QgZXhpc3RzUG9zaXRpb246IE5nRG9jT3ZlcmxheVBvc2l0aW9uID0gT2JqZWN0LmtleXMoUE9TSVRJT05fREVTQ1JJUFRJT04pLmZpbmQoXG5cdFx0XHQoa2V5OiBzdHJpbmcpID0+IHtcblx0XHRcdFx0Y29uc3QgcG9zaXRpb25EZXNjcmlwdGlvbjogQ29ubmVjdGVkUG9zaXRpb24gPSBQT1NJVElPTl9ERVNDUklQVElPTltrZXldO1xuXHRcdFx0XHRyZXR1cm4gKFxuXHRcdFx0XHRcdHBvc2l0aW9uUGFpci5vcmlnaW5YID09PSBwb3NpdGlvbkRlc2NyaXB0aW9uLm9yaWdpblggJiZcblx0XHRcdFx0XHRwb3NpdGlvblBhaXIub3JpZ2luWSA9PT0gcG9zaXRpb25EZXNjcmlwdGlvbi5vcmlnaW5ZICYmXG5cdFx0XHRcdFx0cG9zaXRpb25QYWlyLm92ZXJsYXlYID09PSBwb3NpdGlvbkRlc2NyaXB0aW9uLm92ZXJsYXlYICYmXG5cdFx0XHRcdFx0cG9zaXRpb25QYWlyLm92ZXJsYXlZID09PSBwb3NpdGlvbkRlc2NyaXB0aW9uLm92ZXJsYXlZXG5cdFx0XHRcdCk7XG5cdFx0XHR9LFxuXHRcdCkgYXMgTmdEb2NPdmVybGF5UG9zaXRpb247XG5cdFx0cmV0dXJuIGV4aXN0c1Bvc2l0aW9uID8gZXhpc3RzUG9zaXRpb24gOiBwb3NpdGlvblBhaXI7XG5cdH1cbn1cbiJdfQ==