import { __decorate, __metadata } from "tslib";
import { DOCUMENT } from '@angular/common';
import { afterNextRender, ChangeDetectionStrategy, ChangeDetectorRef, Component, Directive, ElementRef, HostBinding, Inject, Input, NgZone, ViewChild, } from '@angular/core';
import { ngDocZoneOptimize } from '@ng-doc/ui-kit/observables';
import { UntilDestroy, untilDestroyed } from '@ngneat/until-destroy';
import { fromEvent, merge } from 'rxjs';
import { debounceTime, filter, map, pairwise, switchMap, take, takeUntil, tap, } from 'rxjs/operators';
import * as i0 from "@angular/core";
export class NgDocPaneFrontDirective {
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.1.0", ngImport: i0, type: NgDocPaneFrontDirective, deps: [], target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "18.1.0", type: NgDocPaneFrontDirective, isStandalone: true, selector: "[ngDocPaneFront]", ngImport: i0 }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.1.0", ngImport: i0, type: NgDocPaneFrontDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[ngDocPaneFront]',
                    standalone: true,
                }]
        }] });
export class NgDocPaneBackDirective {
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.1.0", ngImport: i0, type: NgDocPaneBackDirective, deps: [], target: i0.ɵɵFactoryTarget.Directive }); }
    static { this.ɵdir = i0.ɵɵngDeclareDirective({ minVersion: "14.0.0", version: "18.1.0", type: NgDocPaneBackDirective, isStandalone: true, selector: "[ngDocPaneBack]", ngImport: i0 }); }
}
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.1.0", ngImport: i0, type: NgDocPaneBackDirective, decorators: [{
            type: Directive,
            args: [{
                    selector: '[ngDocPaneBack]',
                    standalone: true,
                }]
        }] });
let NgDocPaneComponent = class NgDocPaneComponent {
    constructor(document, changeDetectorRef, elementRef, ngZone) {
        this.document = document;
        this.changeDetectorRef = changeDetectorRef;
        this.elementRef = elementRef;
        this.ngZone = ngZone;
        this.expanded = false;
        this.width = '0%';
        this.dragging = false;
        afterNextRender(() => {
            if (this.resizer) {
                const mouseDown$ = fromEvent(this.resizer.nativeElement, 'mousedown').pipe(tap(() => {
                    this.dragging = true;
                    this.changeDetectorRef.markForCheck();
                }));
                const mouseUp$ = fromEvent(this.document, 'mouseup').pipe(tap(() => {
                    this.dragging = false;
                    this.changeDetectorRef.markForCheck();
                }));
                const mouseMove$ = fromEvent(this.document, 'mousemove').pipe(map((event) => event.clientX), pairwise(), map(([prev, next]) => next - prev));
                mouseDown$
                    .pipe(switchMap(() => {
                    const dragEvent$ = mouseMove$.pipe(takeUntil(mouseUp$));
                    const clickEvent$ = mouseUp$.pipe(map(() => null), takeUntil(mouseMove$), take(1));
                    return merge(dragEvent$, clickEvent$);
                }), filter((delta) => delta !== 0), ngDocZoneOptimize(this.ngZone), untilDestroyed(this))
                    .subscribe((delta) => {
                    delta === null ? this.toggle() : this.addDelta(delta);
                });
            }
            fromEvent(window, 'resize')
                .pipe(debounceTime(100), untilDestroyed(this), ngDocZoneOptimize(this.ngZone))
                .subscribe(() => this.addDelta(0));
        });
        this.addDelta(0);
    }
    ngOnChanges({ expanded }) {
        if (expanded) {
            expanded.currentValue
                ? this.addDelta(this.elementRef.nativeElement.offsetWidth)
                : this.addDelta(-this.elementRef.nativeElement.offsetWidth);
        }
    }
    toggle() {
        if (this.resizer) {
            const middle = this.elementRef.nativeElement.offsetWidth / 2;
            if (this.resizer.nativeElement.offsetLeft < middle) {
                this.addDelta(this.elementRef.nativeElement.offsetWidth);
            }
            else {
                this.addDelta(-this.elementRef.nativeElement.offsetWidth);
            }
        }
    }
    addDelta(delta) {
        if (this.resizer) {
            const maxWidth = this.elementRef.nativeElement.offsetWidth - this.resizer.nativeElement.offsetWidth;
            this.width = `${Math.min(maxWidth, Math.max(0, this.resizer.nativeElement.offsetLeft + delta))}px`;
            this.changeDetectorRef.detectChanges();
        }
    }
    static { this.ɵfac = i0.ɵɵngDeclareFactory({ minVersion: "12.0.0", version: "18.1.0", ngImport: i0, type: NgDocPaneComponent, deps: [{ token: DOCUMENT }, { token: i0.ChangeDetectorRef }, { token: i0.ElementRef }, { token: i0.NgZone }], target: i0.ɵɵFactoryTarget.Component }); }
    static { this.ɵcmp = i0.ɵɵngDeclareComponent({ minVersion: "14.0.0", version: "18.1.0", type: NgDocPaneComponent, isStandalone: true, selector: "ng-doc-pane", inputs: { expanded: "expanded" }, host: { properties: { "attr.data-ng-doc-dragging": "this.dragging" } }, viewQueries: [{ propertyName: "resizer", first: true, predicate: ["resizer"], descendants: true, static: true }], usesOnChanges: true, ngImport: i0, template: "<div class=\"ng-doc-pane-back\" [style.width]=\"width\">\n\t<div class=\"ng-doc-pane-content\">\n\t\t<ng-content select=\"[ngDocPaneBack]\"></ng-content>\n\t</div>\n</div>\n<div class=\"ng-doc-pane-resizer\" #resizer></div>\n<div class=\"ng-doc-pane-front\">\n\t<div class=\"ng-doc-pane-content\">\n\t\t<ng-content select=\"[ngDocPaneFront]\"></ng-content>\n\t</div>\n</div>\n", styles: [":host{position:relative;display:flex;width:100%;border-radius:var(--ng-doc-pane-border-radius, var(--ng-doc-base-gutter));border:var(--ng-doc-pane-border, 1px solid var(--ng-doc-border-color));overflow:hidden}:host[data-ng-doc-dragging=false] .ng-doc-pane-back{transition:var(--ng-doc-transition) width}:host .ng-doc-pane-front{position:relative;display:flex;width:100%;background-color:var(--ng-doc-pane-front-background, var(--ng-doc-pane-background, var(--ng-doc-base-1)));overflow:hidden;border-top-right-radius:var(--ng-doc-base-gutter);border-bottom-right-radius:var(--ng-doc-base-gutter);border:var(--ng-doc-pane-front-border, var(--ng-doc-pane-border))}:host .ng-doc-pane-back{position:relative;display:flex;flex-shrink:0;width:100%;background-color:var(--ng-doc-pane-back-background, var(--ng-doc-pane-background, var(--ng-doc-base-1)));overflow:hidden;border-top-left-radius:var(--ng-doc-base-gutter);border-bottom-left-radius:var(--ng-doc-base-gutter);border:var(--ng-doc-pane-back-border, var(--ng-doc-pane-border))}:host .ng-doc-pane-resizer{position:relative;flex-shrink:0;transform:translateZ(0);background-color:var(--ng-doc-base-3);width:16px;display:block;cursor:ew-resize}:host .ng-doc-pane-resizer:after{content:\"\";display:flex;background:var(--ng-doc-base-10);border-radius:50px;position:absolute;width:4px;height:20%;top:50%;left:50%;transform:translateY(-50%) translate(-50%);opacity:1;transition:var(--ng-doc-transition) height}:host .ng-doc-pane-content{display:flex;align-items:center;justify-content:center;flex-shrink:0;width:100%;height:100%;min-width:var(--ng-doc-pane-content-min-width, 200px)}\n"], changeDetection: i0.ChangeDetectionStrategy.OnPush }); }
};
NgDocPaneComponent = __decorate([
    UntilDestroy(),
    __metadata("design:paramtypes", [Document,
        ChangeDetectorRef,
        ElementRef,
        NgZone])
], NgDocPaneComponent);
export { NgDocPaneComponent };
i0.ɵɵngDeclareClassMetadata({ minVersion: "12.0.0", version: "18.1.0", ngImport: i0, type: NgDocPaneComponent, decorators: [{
            type: Component,
            args: [{ selector: 'ng-doc-pane', changeDetection: ChangeDetectionStrategy.OnPush, standalone: true, template: "<div class=\"ng-doc-pane-back\" [style.width]=\"width\">\n\t<div class=\"ng-doc-pane-content\">\n\t\t<ng-content select=\"[ngDocPaneBack]\"></ng-content>\n\t</div>\n</div>\n<div class=\"ng-doc-pane-resizer\" #resizer></div>\n<div class=\"ng-doc-pane-front\">\n\t<div class=\"ng-doc-pane-content\">\n\t\t<ng-content select=\"[ngDocPaneFront]\"></ng-content>\n\t</div>\n</div>\n", styles: [":host{position:relative;display:flex;width:100%;border-radius:var(--ng-doc-pane-border-radius, var(--ng-doc-base-gutter));border:var(--ng-doc-pane-border, 1px solid var(--ng-doc-border-color));overflow:hidden}:host[data-ng-doc-dragging=false] .ng-doc-pane-back{transition:var(--ng-doc-transition) width}:host .ng-doc-pane-front{position:relative;display:flex;width:100%;background-color:var(--ng-doc-pane-front-background, var(--ng-doc-pane-background, var(--ng-doc-base-1)));overflow:hidden;border-top-right-radius:var(--ng-doc-base-gutter);border-bottom-right-radius:var(--ng-doc-base-gutter);border:var(--ng-doc-pane-front-border, var(--ng-doc-pane-border))}:host .ng-doc-pane-back{position:relative;display:flex;flex-shrink:0;width:100%;background-color:var(--ng-doc-pane-back-background, var(--ng-doc-pane-background, var(--ng-doc-base-1)));overflow:hidden;border-top-left-radius:var(--ng-doc-base-gutter);border-bottom-left-radius:var(--ng-doc-base-gutter);border:var(--ng-doc-pane-back-border, var(--ng-doc-pane-border))}:host .ng-doc-pane-resizer{position:relative;flex-shrink:0;transform:translateZ(0);background-color:var(--ng-doc-base-3);width:16px;display:block;cursor:ew-resize}:host .ng-doc-pane-resizer:after{content:\"\";display:flex;background:var(--ng-doc-base-10);border-radius:50px;position:absolute;width:4px;height:20%;top:50%;left:50%;transform:translateY(-50%) translate(-50%);opacity:1;transition:var(--ng-doc-transition) height}:host .ng-doc-pane-content{display:flex;align-items:center;justify-content:center;flex-shrink:0;width:100%;height:100%;min-width:var(--ng-doc-pane-content-min-width, 200px)}\n"] }]
        }], ctorParameters: () => [{ type: Document, decorators: [{
                    type: Inject,
                    args: [DOCUMENT]
                }] }, { type: i0.ChangeDetectorRef }, { type: i0.ElementRef }, { type: i0.NgZone }], propDecorators: { expanded: [{
                type: Input
            }], resizer: [{
                type: ViewChild,
                args: ['resizer', { static: true }]
            }], dragging: [{
                type: HostBinding,
                args: ['attr.data-ng-doc-dragging']
            }] } });
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoicGFuZS5jb21wb25lbnQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyIuLi8uLi8uLi8uLi8uLi8uLi9saWJzL3VpLWtpdC9jb21wb25lbnRzL3BhbmUvcGFuZS5jb21wb25lbnQudHMiLCIuLi8uLi8uLi8uLi8uLi8uLi9saWJzL3VpLWtpdC9jb21wb25lbnRzL3BhbmUvcGFuZS5jb21wb25lbnQuaHRtbCJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiO0FBQUEsT0FBTyxFQUFFLFFBQVEsRUFBRSxNQUFNLGlCQUFpQixDQUFDO0FBQzNDLE9BQU8sRUFDTixlQUFlLEVBQ2YsdUJBQXVCLEVBQ3ZCLGlCQUFpQixFQUNqQixTQUFTLEVBQ1QsU0FBUyxFQUNULFVBQVUsRUFDVixXQUFXLEVBQ1gsTUFBTSxFQUNOLEtBQUssRUFDTCxNQUFNLEVBR04sU0FBUyxHQUNULE1BQU0sZUFBZSxDQUFDO0FBQ3ZCLE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxNQUFNLDRCQUE0QixDQUFDO0FBQy9ELE9BQU8sRUFBRSxZQUFZLEVBQUUsY0FBYyxFQUFFLE1BQU0sdUJBQXVCLENBQUM7QUFDckUsT0FBTyxFQUFFLFNBQVMsRUFBRSxLQUFLLEVBQWMsTUFBTSxNQUFNLENBQUM7QUFDcEQsT0FBTyxFQUNOLFlBQVksRUFDWixNQUFNLEVBQ04sR0FBRyxFQUNILFFBQVEsRUFDUixTQUFTLEVBQ1QsSUFBSSxFQUNKLFNBQVMsRUFDVCxHQUFHLEdBQ0gsTUFBTSxnQkFBZ0IsQ0FBQzs7QUFNeEIsTUFBTSxPQUFPLHVCQUF1Qjs4R0FBdkIsdUJBQXVCO2tHQUF2Qix1QkFBdUI7OzJGQUF2Qix1QkFBdUI7a0JBSm5DLFNBQVM7bUJBQUM7b0JBQ1YsUUFBUSxFQUFFLGtCQUFrQjtvQkFDNUIsVUFBVSxFQUFFLElBQUk7aUJBQ2hCOztBQU9ELE1BQU0sT0FBTyxzQkFBc0I7OEdBQXRCLHNCQUFzQjtrR0FBdEIsc0JBQXNCOzsyRkFBdEIsc0JBQXNCO2tCQUpsQyxTQUFTO21CQUFDO29C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QUMsYUFBYSxDQUFDLFdBQVcsR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxXQUFXLENBQUM7WUFFcEYsSUFBSSxDQUFDLEtBQUssR0FBRyxHQUFHLElBQUksQ0FBQyxHQUFHLENBQ3ZCLFFBQVEsRUFDUixJQUFJLENBQUMsR0FBRyxDQUFDLENBQUMsRUFBRSxJQUFJLENBQUMsT0FBTyxDQUFDLGFBQWEsQ0FBQyxVQUFVLEdBQUcsS0FBSyxDQUFDLENBQzFELElBQUksQ0FBQztZQUVOLElBQUksQ0FBQyxpQkFBaUIsQ0FBQyxhQUFhLEVBQUUsQ0FBQztRQUN4QyxDQUFDO0lBQ0YsQ0FBQzs4R0F2R1csa0JBQWtCLGtCQWFyQixRQUFRO2tHQWJMLGtCQUFrQix3VENsRC9CLDBYQVdBOztBRHVDYSxrQkFBa0I7SUFEOUIsWUFBWSxFQUFFO3FDQWVjLFFBQVE7UUFDQyxpQkFBaUI7UUFDeEIsVUFBVTtRQUNkLE1BQU07R0FqQnBCLGtCQUFrQixDQXdHOUI7OzJGQXhHWSxrQkFBa0I7a0JBUjlCLFNBQVM7K0JBQ0MsYUFBYSxtQkFHTix1QkFBdUIsQ0FBQyxNQUFNLGNBQ25DLElBQUk7OzBCQWdCZCxNQUFNOzJCQUFDLFFBQVE7dUhBWGpCLFFBQVE7c0JBRFAsS0FBSztnQkFJTixPQUFPO3NCQUROLFNBQVM7dUJBQUMsU0FBUyxFQUFFLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRTtnQkFNdEMsUUFBUTtzQkFEUCxXQUFXO3VCQUFDLDJCQUEyQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IERPQ1VNRU5UIH0gZnJvbSAnQGFuZ3VsYXIvY29tbW9uJztcbmltcG9ydCB7XG5cdGFmdGVyTmV4dFJlbmRlcixcblx0Q2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3ksXG5cdENoYW5nZURldGVjdG9yUmVmLFxuXHRDb21wb25lbnQsXG5cdERpcmVjdGl2ZSxcblx0RWxlbWVudFJlZixcblx0SG9zdEJpbmRpbmcsXG5cdEluamVjdCxcblx0SW5wdXQsXG5cdE5nWm9uZSxcblx0T25DaGFuZ2VzLFxuXHRTaW1wbGVDaGFuZ2VzLFxuXHRWaWV3Q2hpbGQsXG59IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHsgbmdEb2Nab25lT3B0aW1pemUgfSBmcm9tICdAbmctZG9jL3VpLWtpdC9vYnNlcnZhYmxlcyc7XG5pbXBvcnQgeyBVbnRpbERlc3Ryb3ksIHVudGlsRGVzdHJveWVkIH0gZnJvbSAnQG5nbmVhdC91bnRpbC1kZXN0cm95JztcbmltcG9ydCB7IGZyb21FdmVudCwgbWVyZ2UsIE9ic2VydmFibGUgfSBmcm9tICdyeGpzJztcbmltcG9ydCB7XG5cdGRlYm91bmNlVGltZSxcblx0ZmlsdGVyLFxuXHRtYXAsXG5cdHBhaXJ3aXNlLFxuXHRzd2l0Y2hNYXAsXG5cdHRha2UsXG5cdHRha2VVbnRpbCxcblx0dGFwLFxufSBmcm9tICdyeGpzL29wZXJhdG9ycyc7XG5cbkBEaXJlY3RpdmUoe1xuXHRzZWxlY3RvcjogJ1tuZ0RvY1BhbmVGcm9udF0nLFxuXHRzdGFuZGFsb25lOiB0cnVlLFxufSlcbmV4cG9ydCBjbGFzcyBOZ0RvY1BhbmVGcm9udERpcmVjdGl2ZSB7fVxuXG5ARGlyZWN0aXZlKHtcblx0c2VsZWN0b3I6ICdbbmdEb2NQYW5lQmFja10nLFxuXHRzdGFuZGFsb25lOiB0cnVlLFxufSlcbmV4cG9ydCBjbGFzcyBOZ0RvY1BhbmVCYWNrRGlyZWN0aXZlIHt9XG5cbkBDb21wb25lbnQoe1xuXHRzZWxlY3RvcjogJ25nLWRvYy1wYW5lJyxcblx0dGVtcGxhdGVVcmw6ICcuL3BhbmUuY29tcG9uZW50Lmh0bWwnLFxuXHRzdHlsZVVybHM6IFsnLi9wYW5lLmNvbXBvbmVudC5zY3NzJ10sXG5cdGNoYW5nZURldGVjdGlvbjogQ2hhbmdlRGV0ZWN0aW9uU3RyYXRlZ3kuT25QdXNoLFxuXHRzdGFuZGFsb25lOiB0cnVlLFxufSlcbkBVbnRpbERlc3Ryb3koKVxuZXhwb3J0IGNsYXNzIE5nRG9jUGFuZUNvbXBvbmVudCBpbXBsZW1lbnRzIE9uQ2hhbmdlcyB7XG5cdEBJbnB1dCgpXG5cdGV4cGFuZGVkOiBib29sZWFuID0gZmFsc2U7XG5cblx0QFZpZXdDaGlsZCgncmVzaXplcicsIHsgc3RhdGljOiB0cnVlIH0pXG5cdHJlc2l6ZXI/OiBFbGVtZW50UmVmPEhUTUxFbGVtZW50PjtcblxuXHR3aWR0aDogc3RyaW5nID0gJzAlJztcblxuXHRASG9zdEJpbmRpbmcoJ2F0dHIuZGF0YS1uZy1kb2MtZHJhZ2dpbmcnKVxuXHRkcmFnZ2luZzogYm9vbGVhbiA9IGZhbHNlO1xuXG5cdGNvbnN0cnVjdG9yKFxuXHRcdEBJbmplY3QoRE9DVU1FTlQpXG5cdFx0cHJpdmF0ZSByZWFkb25seSBkb2N1bWVudDogRG9jdW1lbnQsXG5cdFx0cHJpdmF0ZSByZWFkb25seSBjaGFuZ2VEZXRlY3RvclJlZjogQ2hhbmdlRGV0ZWN0b3JSZWYsXG5cdFx0cHJpdmF0ZSByZWFkb25seSBlbGVtZW50UmVmOiBFbGVtZW50UmVmPEhUTUxFbGVtZW50Pixcblx0XHRwcml2YXRlIHJlYWRvbmx5IG5nWm9uZTogTmdab25lLFxuXHQpIHtcblx0XHRhZnRlck5leHRSZW5kZXIoKCkgPT4ge1xuXHRcdFx0aWYgKHRoaXMucmVzaXplcikge1xuXHRcdFx0XHRjb25zdCBtb3VzZURvd24kID0gZnJvbUV2ZW50KHRoaXMucmVzaXplci5uYXRpdmVFbGVtZW50LCAnbW91c2Vkb3duJykucGlwZShcblx0XHRcdFx0XHR0YXAoKCkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5kcmFnZ2luZyA9IHRydWU7XG5cdFx0XHRcdFx0XHR0aGlzLmNoYW5nZURldGVjdG9yUmVmLm1hcmtGb3JDaGVjaygpO1xuXHRcdFx0XHRcdH0pLFxuXHRcdFx0XHQpO1xuXG5cdFx0XHRcdGNvbnN0IG1vdXNlVXAkID0gZnJvbUV2ZW50KHRoaXMuZG9jdW1lbnQsICdtb3VzZXVwJykucGlwZShcblx0XHRcdFx0XHR0YXAoKCkgPT4ge1xuXHRcdFx0XHRcdFx0dGhpcy5kcmFnZ2luZyA9IGZhbHNlO1xuXHRcdFx0XHRcdFx0dGhpcy5jaGFuZ2VEZXRlY3RvclJlZi5tYXJrRm9yQ2hlY2soKTtcblx0XHRcdFx0XHR9KSxcblx0XHRcdFx0KTtcblxuXHRcdFx0XHRjb25zdCBtb3VzZU1vdmUkID0gKGZyb21FdmVudCh0aGlzLmRvY3VtZW50LCAnbW91c2Vtb3ZlJykgYXMgT2JzZXJ2YWJsZTxNb3VzZUV2ZW50PikucGlwZShcblx0XHRcdFx0XHRtYXAoKGV2ZW50OiBNb3VzZUV2ZW50KSA9PiBldmVudC5jbGllbnRYKSxcblx0XHRcdFx0XHRwYWlyd2lzZSgpLFxuXHRcdFx0XHRcdG1hcCgoW3ByZXYsIG5leHRdOiBbbnVtYmVyLCBudW1iZXJdKSA9PiBuZXh0IC0gcHJldiksXG5cdFx0XHRcdCk7XG5cblx0XHRcdFx0bW91c2VEb3duJFxuXHRcdFx0XHRcdC5waXBlKFxuXHRcdFx0XHRcdFx0c3dpdGNoTWFwKCgpID0+IHtcblx0XHRcdFx0XHRcdFx0Y29uc3QgZHJhZ0V2ZW50JCA9IG1vdXNlTW92ZSQucGlwZSh0YWtlVW50aWwobW91c2VVcCQpKTtcblxuXHRcdFx0XHRcdFx0XHRjb25zdCBjbGlja0V2ZW50JCA9IG1vdXNlVXAkLnBpcGUoXG5cdFx0XHRcdFx0XHRcdFx0bWFwKCgpID0+IG51bGwpLFxuXHRcdFx0XHRcdFx0XHRcdHRha2VVbnRpbChtb3VzZU1vdmUkKSxcblx0XHRcdFx0XHRcdFx0XHR0YWtlKDEpLFxuXHRcdFx0XHRcdFx0XHQpO1xuXG5cdFx0XHRcdFx0XHRcdHJldHVybiBtZXJnZShkcmFnRXZlbnQkLCBjbGlja0V2ZW50JCk7XG5cdFx0XHRcdFx0XHR9KSxcblx0XHRcdFx0XHRcdGZpbHRlcigoZGVsdGE6IG51bWJlciB8IG51bGwpID0+IGRlbHRhICE9PSAwKSxcblx0XHRcdFx0XHRcdG5nRG9jWm9uZU9wdGltaXplKHRoaXMubmdab25lKSxcblx0XHRcdFx0XHRcdHVudGlsRGVzdHJveWVkKHRoaXMpLFxuXHRcdFx0XHRcdClcblx0XHRcdFx0XHQuc3Vic2NyaWJlKChkZWx0YTogbnVtYmVyIHwgbnVsbCkgPT4ge1xuXHRcdFx0XHRcdFx0ZGVsdGEgPT09IG51bGwgPyB0aGlzLnRvZ2dsZSgpIDogdGhpcy5hZGREZWx0YShkZWx0YSk7XG5cdFx0XHRcdFx0fSk7XG5cdFx0XHR9XG5cblx0XHRcdGZyb21FdmVudCh3aW5kb3csICdyZXNpemUnKVxuXHRcdFx0XHQucGlwZShkZWJvdW5jZVRpbWUoMTAwKSwgdW50aWxEZXN0cm95ZWQodGhpcyksIG5nRG9jWm9uZU9wdGltaXplKHRoaXMubmdab25lKSlcblx0XHRcdFx0LnN1YnNjcmliZSgoKSA9PiB0aGlzLmFkZERlbHRhKDApKTtcblx0XHR9KTtcblxuXHRcdHRoaXMuYWRkRGVsdGEoMCk7XG5cdH1cblxuXHRuZ09uQ2hhbmdlcyh7IGV4cGFuZGVkIH06IFNpbXBsZUNoYW5nZXMpOiB2b2lkIHtcblx0XHRpZiAoZXhwYW5kZWQpIHtcblx0XHRcdGV4cGFuZGVkLmN1cnJlbnRWYWx1ZVxuXHRcdFx0XHQ/IHRoaXMuYWRkRGVsdGEodGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGgpXG5cdFx0XHRcdDogdGhpcy5hZGREZWx0YSgtdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGgpO1xuXHRcdH1cblx0fVxuXG5cdHRvZ2dsZSgpOiB2b2lkIHtcblx0XHRpZiAodGhpcy5yZXNpemVyKSB7XG5cdFx0XHRjb25zdCBtaWRkbGUgPSB0aGlzLmVsZW1lbnRSZWYubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aCAvIDI7XG5cblx0XHRcdGlmICh0aGlzLnJlc2l6ZXIubmF0aXZlRWxlbWVudC5vZmZzZXRMZWZ0IDwgbWlkZGxlKSB7XG5cdFx0XHRcdHRoaXMuYWRkRGVsdGEodGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGgpO1xuXHRcdFx0fSBlbHNlIHtcblx0XHRcdFx0dGhpcy5hZGREZWx0YSgtdGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGgpO1xuXHRcdFx0fVxuXHRcdH1cblx0fVxuXG5cdHByaXZhdGUgYWRkRGVsdGEoZGVsdGE6IG51bWJlcik6IHZvaWQge1xuXHRcdGlmICh0aGlzLnJlc2l6ZXIpIHtcblx0XHRcdGNvbnN0IG1heFdpZHRoID1cblx0XHRcdFx0dGhpcy5lbGVtZW50UmVmLm5hdGl2ZUVsZW1lbnQub2Zmc2V0V2lkdGggLSB0aGlzLnJlc2l6ZXIubmF0aXZlRWxlbWVudC5vZmZzZXRXaWR0aDtcblxuXHRcdFx0dGhpcy53aWR0aCA9IGAke01hdGgubWluKFxuXHRcdFx0XHRtYXhXaWR0aCxcblx0XHRcdFx0TWF0aC5tYXgoMCwgdGhpcy5yZXNpemVyLm5hdGl2ZUVsZW1lbnQub2Zmc2V0TGVmdCArIGRlbHRhKSxcblx0XHRcdCl9cHhgO1xuXG5cdFx0XHR0aGlzLmNoYW5nZURldGVjdG9yUmVmLmRldGVjdENoYW5nZXMoKTtcblx0XHR9XG5cdH1cbn1cbiIsIjxkaXYgY2xhc3M9XCJuZy1kb2MtcGFuZS1iYWNrXCIgW3N0eWxlLndpZHRoXT1cIndpZHRoXCI+XG5cdDxkaXYgY2xhc3M9XCJuZy1kb2MtcGFuZS1jb250ZW50XCI+XG5cdFx0PG5nLWNvbnRlbnQgc2VsZWN0PVwiW25nRG9jUGFuZUJhY2tdXCI+PC9uZy1jb250ZW50PlxuXHQ8L2Rpdj5cbjwvZGl2PlxuPGRpdiBjbGFzcz1cIm5nLWRvYy1wYW5lLXJlc2l6ZXJcIiAjcmVzaXplcj48L2Rpdj5cbjxkaXYgY2xhc3M9XCJuZy1kb2MtcGFuZS1mcm9udFwiPlxuXHQ8ZGl2IGNsYXNzPVwibmctZG9jLXBhbmUtY29udGVudFwiPlxuXHRcdDxuZy1jb250ZW50IHNlbGVjdD1cIltuZ0RvY1BhbmVGcm9udF1cIj48L25nLWNvbnRlbnQ+XG5cdDwvZGl2PlxuPC9kaXY+XG4iXX0=